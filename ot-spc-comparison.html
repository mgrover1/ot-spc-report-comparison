
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Import libraries &#8212; Analysis Project Template</title>
    
  <link href="_static/css/theme.css" rel="stylesheet" />
  <link href="_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.e8f53015daec13862f6db5e763c41738.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Introduction" href="intro.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      
      <h1 class="site-logo" id="site-title">Analysis Project Template</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Introduction
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Import libraries
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/ot-spc-comparison.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/ot-spc-comparison.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Import libraries
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bring-in-data-and-clean-it-up">
   Bring in Data and Clean it Up
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#first-start-with-the-spc-reports-which-are-reported-to-the-storm-prediction-center-collected-and-filtered-by-the-national-centers-for-environmental-information-ncei-storm-report-archive-data-included-in-this-study-is-january-1-2020-to-august-31-2020">
     First, start with the SPC reports, which are reported to the Storm Prediction Center, collected and filtered by the National Centers for Environmental Information NCEI Storm Report Archive - data included in this study is January 1 2020 to August 31 2020
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#there-are-some-caveats-to-this-dataset-primarily">
     There are some caveats to this dataset - primarily
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#now-we-move-onto-the-ot-data-which-was-derived-from-goes-16-imagery-10-april-to-30-september-2020">
     Now, we move onto the OT Data, which was derived from GOES-16 imagery - 10 April to 30 September 2020
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#now-match-the-ots-with-spc-damage-reports">
   Now, match the OTs with SPC Damage Reports
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-methodology-used-here-is-similar-to-dworak-and-bedka-2012-using-the-following-spatiotemporal-thresholds">
     The methodology used here is similar to Dworak and Bedka (2012), using the following spatiotemporal thresholds
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#now-do-some-linear-regression-to-see-how-various-ot-characteristics-match-up-with-the-damage-reports">
     Now do some linear regression to see how various OT characteristics match up with the damage reports
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#hail-analysis">
       Hail Analysis
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#wind-analysis">
       Wind Analysis
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plot-5x5-degree-grid-boxes">
   Plot 5x5 degree grid boxes
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#these-are-the-5x5-degree-boxes-within-the-domain-of-this-study">
     These are the 5x5 degree boxes within the domain of this study
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="import-libraries">
<h1>Import libraries<a class="headerlink" href="#import-libraries" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
<span class="kn">import</span> <span class="nn">cartopy.feature</span> <span class="k">as</span> <span class="nn">cfeature</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>
<span class="kn">from</span> <span class="nn">shapely.geometry</span> <span class="kn">import</span> <span class="n">Polygon</span><span class="p">,</span> <span class="n">Point</span>
<span class="kn">import</span> <span class="nn">scipy</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">shapely</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

<span class="n">llcrnr</span><span class="o">=</span><span class="p">[</span><span class="mf">14.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">105.5</span><span class="p">]</span>
<span class="n">urcrnr</span><span class="o">=</span><span class="p">[</span><span class="mi">48</span><span class="p">,</span> <span class="o">-</span><span class="mf">64.9</span><span class="p">]</span>
    
<span class="n">cent_lat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">llcrnr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">urcrnr</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">cent_lon</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">urcrnr</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">llcrnr</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="bring-in-data-and-clean-it-up">
<h1>Bring in Data and Clean it Up<a class="headerlink" href="#bring-in-data-and-clean-it-up" title="Permalink to this headline">¶</a></h1>
<div class="section" id="first-start-with-the-spc-reports-which-are-reported-to-the-storm-prediction-center-collected-and-filtered-by-the-national-centers-for-environmental-information-ncei-storm-report-archive-data-included-in-this-study-is-january-1-2020-to-august-31-2020">
<h2>First, start with the SPC reports, which are reported to the <a class="reference external" href="https://www.spc.noaa.gov/climo/online/">Storm Prediction Center</a>, collected and filtered by the National Centers for Environmental Information <a class="reference external" href="https://www.ncdc.noaa.gov/stormevents/">NCEI Storm Report Archive</a> - data included in this study is January 1 2020 to August 31 2020<a class="headerlink" href="#first-start-with-the-spc-reports-which-are-reported-to-the-storm-prediction-center-collected-and-filtered-by-the-national-centers-for-environmental-information-ncei-storm-report-archive-data-included-in-this-study-is-january-1-2020-to-august-31-2020" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="there-are-some-caveats-to-this-dataset-primarily">
<h2>There are some caveats to this dataset - primarily<a class="headerlink" href="#there-are-some-caveats-to-this-dataset-primarily" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Population bias (people send in the reports)</p></li>
<li><p>Hail can be difficult to report accurately (it can melt)</p></li>
<li><p>EF rating is based on DAMAGE not actual wind speed</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read in location data</span>
<span class="n">locations</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/StormEvents_locations-ftp_v1.0_d2020_c20210223.csv&#39;</span><span class="p">)</span>

<span class="c1"># Read in event details</span>
<span class="n">details</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/StormEvents_details-ftp_v1.0_d2020_c20210223.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Use the location data to create a geodataframe, using latitude and longitude values</span>
<span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">locations</span><span class="p">,</span>
                       <span class="n">geometry</span><span class="o">=</span><span class="n">gpd</span><span class="o">.</span><span class="n">points_from_xy</span><span class="p">(</span><span class="n">locations</span><span class="o">.</span><span class="n">LONGITUDE</span><span class="p">,</span>
                                                   <span class="n">locations</span><span class="o">.</span><span class="n">LATITUDE</span><span class="p">),</span>
                       <span class="n">crs</span><span class="o">=</span><span class="s2">&quot;EPSG:4326&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Do an attribute join based on Event ID</span>
<span class="n">spc_events</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">details</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;EVENT_ID&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add an EF rating category, which cleans up the data so the digit is not buried in string</span>
<span class="n">spc_events</span><span class="p">[</span><span class="s1">&#39;EF_RATING&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">spc_events</span><span class="o">.</span><span class="n">TOR_F_SCALE</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="s1">&#39;(\d+)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="now-we-move-onto-the-ot-data-which-was-derived-from-goes-16-imagery-10-april-to-30-september-2020">
<h2>Now, we move onto the OT Data, which was derived from GOES-16 imagery - 10 April to 30 September 2020<a class="headerlink" href="#now-we-move-onto-the-ot-data-which-was-derived-from-goes-16-imagery-10-april-to-30-september-2020" title="Permalink to this headline">¶</a></h2>
<p>The algorithm has already been run for this case, using a method similar to Marion et al. 2019. The minimum brightness temperature serves as the center point, as in the schematic - the steps are as follows:</p>
<ol class="simple">
<li><p>Find an OT (pink point)</p></li>
<li><p>Extract 8 radials (red arrows) starting at middle point and find inflection points (black points) in brightness temperature field (where 2nd derivative = 0</p></li>
<li><p>Use inflection points as OT edge and create a Polygon</p></li>
<li><p>Project to equal area projection and determine area of OT</p></li>
</ol>
<p><img alt="" src="figures/ot_methods.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read in the OT data from the geojson</span>
<span class="n">ot_data</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s1">&#39;data/ots_20200410_20200930.geojson&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;area_polygon&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert the OT data from polygon to point data, using the parallax corrected minimum brightness temperature point</span>
<span class="n">ota_geom</span> <span class="o">=</span> <span class="p">[</span><span class="n">Point</span><span class="p">(</span><span class="n">xy</span><span class="p">)</span> <span class="k">for</span> <span class="n">xy</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ot_data</span><span class="o">.</span><span class="n">lon_corr</span><span class="p">,</span> <span class="n">ot_data</span><span class="o">.</span><span class="n">lat_corr</span><span class="p">)]</span>

<span class="c1"># Add the new geometry to the geodataframe</span>
<span class="n">ot_data</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">ot_data</span><span class="p">,</span> <span class="n">geometry</span><span class="o">=</span><span class="n">ota_geom</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="s2">&quot;EPSG:4326&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ot_data</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">ot_data</span><span class="o">.</span><span class="n">time</span><span class="p">)</span>
<span class="n">spc_events</span><span class="p">[</span><span class="s1">&#39;BEGIN_DATE_TIME&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">spc_events</span><span class="o">.</span><span class="n">BEGIN_DATE_TIME</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">convert_time</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">timezone</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">time</span><span class="o">.</span><span class="n">tz_localize</span><span class="p">(</span><span class="n">zone_dict</span><span class="p">[</span><span class="n">timezone</span><span class="p">])</span><span class="o">.</span><span class="n">tz_convert</span><span class="p">(</span><span class="s1">&#39;utc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">zone_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;AST-4&#39;</span><span class="p">:</span><span class="s1">&#39;Canada/Atlantic&#39;</span><span class="p">,</span>
             <span class="s1">&#39;CST-6&#39;</span><span class="p">:</span><span class="s1">&#39;US/Central&#39;</span><span class="p">,</span>
             <span class="s1">&#39;EST-5&#39;</span><span class="p">:</span><span class="s1">&#39;US/Eastern&#39;</span><span class="p">,</span>
             <span class="s1">&#39;MST-7&#39;</span><span class="p">:</span><span class="s1">&#39;US/Mountain&#39;</span><span class="p">,</span>
             <span class="s1">&#39;PST-8&#39;</span><span class="p">:</span><span class="s1">&#39;US/Pacific&#39;</span><span class="p">,</span>
             <span class="s1">&#39;AKST-9&#39;</span><span class="p">:</span><span class="s1">&#39;US/Alaska&#39;</span><span class="p">,</span>
             <span class="s1">&#39;GST10&#39;</span><span class="p">:</span><span class="s1">&#39;Oman&#39;</span><span class="p">,</span>
             <span class="s1">&#39;HST-10&#39;</span><span class="p">:</span><span class="s1">&#39;US/Hawaii&#39;</span><span class="p">,</span>
             <span class="s1">&#39;SST-11&#39;</span><span class="p">:</span><span class="s1">&#39;US/Samoa&#39;</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spc_events</span> <span class="o">=</span> <span class="n">spc_events</span><span class="p">[(</span><span class="n">spc_events</span><span class="o">.</span><span class="n">EVENT_TYPE</span> <span class="o">==</span> <span class="s1">&#39;Hail&#39;</span><span class="p">)</span>  <span class="o">|</span> <span class="p">(</span><span class="n">spc_events</span><span class="o">.</span><span class="n">EVENT_TYPE</span> <span class="o">==</span> <span class="s1">&#39;Tornado&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">spc_events</span><span class="o">.</span><span class="n">EVENT_TYPE</span> <span class="o">==</span> <span class="s1">&#39;Thunderstorm Wind&#39;</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spc_events</span> <span class="o">=</span> <span class="n">spc_events</span><span class="p">[</span><span class="n">spc_events</span><span class="o">.</span><span class="n">CZ_TIMEZONE</span> <span class="o">!=</span> <span class="s1">&#39;GST10&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">conv_times</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">spc_events</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">conv_times</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">convert_time</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;BEGIN_DATE_TIME&#39;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;CZ_TIMEZONE&#39;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spc_events</span><span class="p">[</span><span class="s1">&#39;datetime_utc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">conv_times</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>

<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">LAND</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">STATES</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">LAKES</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ot_data</span><span class="o">.</span><span class="n">lon_corr</span><span class="p">,</span> <span class="n">ot_data</span><span class="o">.</span><span class="n">lat_corr</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;OTs Observed by GOES-16 </span><span class="se">\n</span><span class="s1"> 10 April - 30 September 2021&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="c1">#c = ot_data.plot(ax=ax, legend=True)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;ot_locs.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ot-spc-comparison_17_0.png" src="_images/ot-spc-comparison_17_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>

<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">LAND</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">STATES</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">LAKES</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">spc_sub</span><span class="o">.</span><span class="n">BEGIN_LON</span><span class="p">,</span> <span class="n">spc_sub</span><span class="o">.</span><span class="n">BEGIN_LAT</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.PathCollection at 0x7f278e0eeba8&gt;
</pre></div>
</div>
<img alt="_images/ot-spc-comparison_18_1.png" src="_images/ot-spc-comparison_18_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spc_sub</span> <span class="o">=</span> <span class="n">spc_events</span><span class="p">[(</span><span class="n">spc_events</span><span class="o">.</span><span class="n">EVENT_TYPE</span> <span class="o">==</span> <span class="s1">&#39;Hail&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">spc_events</span><span class="o">.</span><span class="n">EVENT_TYPE</span> <span class="o">==</span> <span class="s1">&#39;Thunderstorm Wind&#39;</span><span class="p">)</span> <span class="o">|</span> 
                  <span class="p">(</span><span class="n">spc_events</span><span class="o">.</span><span class="n">EVENT_TYPE</span> <span class="o">==</span> <span class="s1">&#39;Tornado&#39;</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hail_sub</span> <span class="o">=</span> <span class="n">spc_sub</span><span class="p">[</span><span class="n">spc_sub</span><span class="o">.</span><span class="n">EVENT_TYPE</span> <span class="o">==</span> <span class="s1">&#39;Hail&#39;</span><span class="p">]</span>
<span class="n">wind_sub</span> <span class="o">=</span> <span class="n">spc_sub</span><span class="p">[</span><span class="n">spc_sub</span><span class="o">.</span><span class="n">EVENT_TYPE</span> <span class="o">==</span> <span class="s1">&#39;Thunderstorm Wind&#39;</span><span class="p">]</span>
<span class="n">torn_sub</span> <span class="o">=</span> <span class="n">spc_sub</span><span class="p">[</span><span class="n">spc_sub</span><span class="o">.</span><span class="n">EVENT_TYPE</span> <span class="o">==</span> <span class="s1">&#39;Tornado&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hail_df</span> <span class="o">=</span> <span class="n">spc_events</span><span class="p">[</span><span class="n">spc_events</span><span class="o">.</span><span class="n">EVENT_TYPE</span> <span class="o">==</span> <span class="s1">&#39;Hail&#39;</span><span class="p">]</span>
<span class="n">wind_df</span> <span class="o">=</span> <span class="n">spc_events</span><span class="p">[</span><span class="n">spc_events</span><span class="o">.</span><span class="n">EVENT_TYPE</span> <span class="o">==</span> <span class="s1">&#39;Thunderstorm Wind&#39;</span><span class="p">]</span>
<span class="n">torn_df</span> <span class="o">=</span> <span class="n">spc_events</span><span class="p">[</span><span class="n">spc_events</span><span class="o">.</span><span class="n">EVENT_TYPE</span> <span class="o">==</span> <span class="s1">&#39;Tornado&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">end_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">22</span><span class="p">)</span>

<span class="n">ot_sub</span> <span class="o">=</span> <span class="n">ot_data</span><span class="p">[(</span><span class="n">ot_data</span><span class="o">.</span><span class="n">time</span> <span class="o">&gt;=</span> <span class="n">start_date</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">ot_data</span><span class="o">.</span><span class="n">time</span> <span class="o">&lt;=</span> <span class="n">end_date</span><span class="p">)]</span>

<span class="n">wind_matches</span> <span class="o">=</span> <span class="n">wind_matched</span><span class="p">[(</span><span class="n">wind_matched</span><span class="o">.</span><span class="n">time</span> <span class="o">&gt;=</span> <span class="n">start_date</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">wind_matched</span><span class="o">.</span><span class="n">time</span> <span class="o">&lt;=</span> <span class="n">end_date</span><span class="p">)]</span>
<span class="n">hail_matches</span> <span class="o">=</span> <span class="n">hail_matched</span><span class="p">[(</span><span class="n">hail_matched</span><span class="o">.</span><span class="n">time</span> <span class="o">&gt;=</span> <span class="n">start_date</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">hail_matched</span><span class="o">.</span><span class="n">time</span> <span class="o">&lt;=</span> <span class="n">end_date</span><span class="p">)]</span>
<span class="n">torn_matches</span> <span class="o">=</span> <span class="n">torn_matched</span><span class="p">[(</span><span class="n">torn_matched</span><span class="o">.</span><span class="n">time</span> <span class="o">&gt;=</span> <span class="n">start_date</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">torn_matched</span><span class="o">.</span><span class="n">time</span> <span class="o">&lt;=</span> <span class="n">end_date</span><span class="p">)]</span>

<span class="n">start_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">start_date</span><span class="p">)</span><span class="o">.</span><span class="n">tz_localize</span><span class="p">(</span><span class="s1">&#39;utc&#39;</span><span class="p">)</span>
<span class="n">end_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">end_date</span><span class="p">)</span><span class="o">.</span><span class="n">tz_localize</span><span class="p">(</span><span class="s1">&#39;utc&#39;</span><span class="p">)</span>

<span class="n">spc_sub</span> <span class="o">=</span> <span class="n">spc_events</span><span class="p">[(</span><span class="n">spc_events</span><span class="o">.</span><span class="n">datetime_utc</span> <span class="o">&gt;=</span> <span class="n">start_date</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">spc_events</span><span class="o">.</span><span class="n">datetime_utc</span> <span class="o">&lt;=</span> <span class="n">end_date</span><span class="p">)]</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;MAGNITUDE&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spc_sub</span> <span class="o">=</span> <span class="n">spc_sub</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;DAMAGE_PROPERTY&#39;</span><span class="p">])</span>

<span class="n">damage_property</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">spc_sub</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">property_total</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;DAMAGE_PROPERTY&#39;</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
    
    <span class="n">damage_property</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">property_total</span><span class="p">)</span>
    
<span class="n">spc_sub</span><span class="p">[</span><span class="s1">&#39;damage_property&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">damage_property</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hail_df</span> <span class="o">=</span> <span class="n">spc_sub</span><span class="p">[</span><span class="n">spc_sub</span><span class="o">.</span><span class="n">EVENT_TYPE</span> <span class="o">==</span> <span class="s1">&#39;Hail&#39;</span><span class="p">]</span>
<span class="n">wind_df</span> <span class="o">=</span> <span class="n">spc_sub</span><span class="p">[</span><span class="n">spc_sub</span><span class="o">.</span><span class="n">EVENT_TYPE</span> <span class="o">==</span> <span class="s1">&#39;Thunderstorm Wind&#39;</span><span class="p">]</span>
<span class="n">torn_df</span> <span class="o">=</span> <span class="n">spc_sub</span><span class="p">[</span><span class="n">spc_sub</span><span class="o">.</span><span class="n">EVENT_TYPE</span> <span class="o">==</span> <span class="s1">&#39;Tornado&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>

<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">LAND</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">STATES</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">LAKES</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ot_sub</span><span class="o">.</span><span class="n">lon_corr</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">ot_sub</span><span class="o">.</span><span class="n">lat_corr</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;OT Locations&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">wind_sub</span><span class="o">.</span><span class="n">BEGIN_LON</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">wind_sub</span><span class="o">.</span><span class="n">BEGIN_LAT</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Wind Reports&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">hail_sub</span><span class="o">.</span><span class="n">BEGIN_LON</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">hail_sub</span><span class="o">.</span><span class="n">BEGIN_LAT</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:green&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Hail Reports&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">torn_sub</span><span class="o">.</span><span class="n">BEGIN_LON</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">torn_sub</span><span class="o">.</span><span class="n">BEGIN_LAT</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Tornado Reports&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">((</span><span class="o">-</span><span class="mi">94</span><span class="p">,</span> <span class="o">-</span><span class="mi">87</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">44</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">spc_sub</span><span class="o">.</span><span class="n">datetime_utc</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">min</span><span class="p">())</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1"> %b %Y %H:%M&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; - &#39;</span> <span class="o">+</span> 
          <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">spc_sub</span><span class="o">.</span><span class="n">datetime_utc</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">max</span><span class="p">())</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1"> %b %Y %H:%M&#39;</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;Match_All_SPC_Reports&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ot-spc-comparison_25_0.png" src="_images/ot-spc-comparison_25_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>

<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">LAND</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">STATES</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">LAKES</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ot_sub</span><span class="o">.</span><span class="n">lon_corr</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">ot_sub</span><span class="o">.</span><span class="n">lat_corr</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;OT Locations&#39;</span><span class="p">)</span>

<span class="c1">#ax.scatter(wind_matches.lon_corr.values, wind_matches.lat_corr.values, color=&#39;Blue&#39;, label=&#39;Wind Report Match&#39;)</span>
<span class="c1">#ax.scatter(hail_matches.lon_corr.values, hail_matches.lat_corr.values, color=&#39;Green&#39;, label=&#39;Hail Reports&#39;)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">wind_matches</span><span class="o">.</span><span class="n">lon_corr</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">wind_matches</span><span class="o">.</span><span class="n">lat_corr</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Wind Reports&#39;</span><span class="p">)</span>



<span class="c1">#c = spc_sub.plot(ax=ax, c=spc_sub.EPISODE_ID_x, legend=True)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">((</span><span class="o">-</span><span class="mi">94</span><span class="p">,</span> <span class="o">-</span><span class="mi">87</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">44</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">spc_sub</span><span class="o">.</span><span class="n">datetime_utc</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">min</span><span class="p">())</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1"> %b %Y %H:%M&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; - &#39;</span> <span class="o">+</span> 
          <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">spc_sub</span><span class="o">.</span><span class="n">datetime_utc</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">max</span><span class="p">())</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1"> %b %Y %H:%M&#39;</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;wind_match.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ot-spc-comparison_26_0.png" src="_images/ot-spc-comparison_26_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="now-match-the-ots-with-spc-damage-reports">
<h1>Now, match the OTs with SPC Damage Reports<a class="headerlink" href="#now-match-the-ots-with-spc-damage-reports" title="Permalink to this headline">¶</a></h1>
<div class="section" id="the-methodology-used-here-is-similar-to-dworak-and-bedka-2012-using-the-following-spatiotemporal-thresholds">
<h2>The methodology used here is similar to Dworak and Bedka (2012), using the following spatiotemporal thresholds<a class="headerlink" href="#the-methodology-used-here-is-similar-to-dworak-and-bedka-2012-using-the-following-spatiotemporal-thresholds" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Within 30 minutes before/after the SPC report</p></li>
<li><p>Within 60 km radius of each other</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add an equal area projection using the central latitude and longitude from the dataset</span>
<span class="n">proj</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">LambertAzimuthalEqualArea</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=</span><span class="n">cent_lon</span><span class="p">,</span> <span class="n">central_latitude</span><span class="o">=</span><span class="n">cent_lat</span><span class="p">)</span><span class="o">.</span><span class="n">proj4_params</span>

<span class="c1"># Project the datasets to the new coordinate reference system</span>
<span class="n">ot_data_proj</span> <span class="o">=</span> <span class="n">ot_data</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">proj</span><span class="p">)</span>
<span class="n">spc_events_proj</span> <span class="o">=</span> <span class="n">spc_events</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">proj</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a function to match OTs with their associated hazards</span>
<span class="k">def</span> <span class="nf">match_report</span><span class="p">(</span><span class="n">hazard_df</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ot_df</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hazard_type</span><span class="o">=</span><span class="s1">&#39;Hail&#39;</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">60000</span><span class="p">,</span> <span class="n">time_int</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">sort_priority</span><span class="o">=</span><span class="s1">&#39;MAGNITUDE&#39;</span><span class="p">,</span>
                 <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Matches SPC reports with OTs using a given maximum radius</span>
<span class="sd">    and time interval</span>
<span class="sd">    </span>
<span class="sd">    Input</span>
<span class="sd">    ==============</span>
<span class="sd">    hazard_df = pandas dataframe with spc reports (should be subset for given hazard - ex. Tornado)</span>
<span class="sd">    </span>
<span class="sd">    ot_df = pandas dataframe with OT characteristics</span>
<span class="sd">    </span>
<span class="sd">    radius = maximum radius (units of meters) to match OTs with SPC reports</span>
<span class="sd">    </span>
<span class="sd">    time_int = maximum time interval (units of minutes) to match OTs with SPC reports</span>
<span class="sd">    </span>
<span class="sd">    Output</span>
<span class="sd">    ==============</span>
<span class="sd">    matched_df = Dataframe with OT/SPC report matches</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">hazard_df</span> <span class="o">=</span> <span class="n">hazard_df</span><span class="p">[</span><span class="n">hazard_df</span><span class="o">.</span><span class="n">EVENT_TYPE</span> <span class="o">==</span> <span class="n">hazard_type</span><span class="p">]</span>
    
    <span class="k">if</span> <span class="n">hazard_type</span> <span class="o">==</span> <span class="s1">&#39;Tornado&#39;</span><span class="p">:</span>
        <span class="n">hazard_df</span><span class="p">[</span><span class="s1">&#39;MAGNITUDE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hazard_df</span><span class="o">.</span><span class="n">EF_RATING</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    
    <span class="n">hazard_df</span> <span class="o">=</span> <span class="n">hazard_df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;MAGNITUDE&#39;</span><span class="p">])</span>
    
    <span class="c1"># Add a 60 km buffer to the SPC dataset</span>
    <span class="n">hazard_df</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hazard_df</span><span class="o">.</span><span class="n">buffer</span><span class="p">(</span><span class="n">radius</span><span class="p">)</span>
    
    <span class="c1"># Complete a spatial join between the two</span>
    <span class="n">join_df</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">sjoin</span><span class="p">(</span><span class="n">ot_df</span><span class="p">,</span> <span class="n">hazard_df</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">,</span> <span class="n">op</span><span class="o">=</span><span class="s1">&#39;intersects&#39;</span><span class="p">)</span>
    
    <span class="c1"># Create new columns for datetime of SPC hazard and OT</span>
    <span class="n">join_df</span><span class="p">[</span><span class="s1">&#39;haz_datetime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">join_df</span><span class="o">.</span><span class="n">datetime_utc</span><span class="p">)</span>
    <span class="n">join_df</span><span class="p">[</span><span class="s1">&#39;ota_datetime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">join_df</span><span class="o">.</span><span class="n">time</span><span class="p">)</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">tz_localize</span><span class="p">(</span><span class="s1">&#39;utc&#39;</span><span class="p">)</span>
    
    <span class="c1"># Find the absolute value of the time difference</span>
    <span class="n">join_df</span><span class="p">[</span><span class="s1">&#39;abs_time_diff&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">join_df</span><span class="o">.</span><span class="n">haz_datetime</span> <span class="o">-</span> <span class="n">join_df</span><span class="o">.</span><span class="n">ota_datetime</span><span class="p">)</span>
    
    <span class="c1"># Find where the time difference is less than or equal to 30 minutes</span>
    <span class="n">matched_times</span> <span class="o">=</span> <span class="n">join_df</span><span class="p">[</span><span class="nb">abs</span><span class="p">(</span><span class="n">join_df</span><span class="o">.</span><span class="n">abs_time_diff</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">minutes</span><span class="o">=</span><span class="n">time_int</span><span class="p">)]</span>
    
    <span class="c1"># Sort through values - default is to take the one with the greatest magnitude (maximum hail)</span>
    <span class="n">matched_df</span> <span class="o">=</span> <span class="n">matched_times</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">sort_priority</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="n">ascending</span><span class="p">)</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="s1">&#39;EVENT_ID&#39;</span><span class="p">,</span> 
                                                                                               <span class="n">keep</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">)</span>
    <span class="c1"># Grab the OT with the largest OTA to make sure there are not any duplicates</span>
    <span class="n">matched_df</span> <span class="o">=</span> <span class="n">matched_times</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;area_polygon&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">([</span><span class="s1">&#39;lon_corr&#39;</span><span class="p">,</span> <span class="s1">&#39;lat_corr&#39;</span><span class="p">],</span>
                                                                                         <span class="n">keep</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">matched_df</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert columns to datetime</span>
<span class="n">ot_data_proj</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">ot_data_proj</span><span class="o">.</span><span class="n">time</span><span class="p">)</span>
<span class="n">spc_events_proj</span><span class="p">[</span><span class="s1">&#39;BEGIN_DATE_TIME&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">spc_events_proj</span><span class="o">.</span><span class="n">BEGIN_DATE_TIME</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add date and month columns to each dataset</span>
<span class="n">ot_data_proj</span><span class="p">[</span><span class="s1">&#39;day&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ot_data_proj</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">day</span>
<span class="n">ot_data_proj</span><span class="p">[</span><span class="s1">&#39;month&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ot_data_proj</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span>

<span class="n">spc_events_proj</span><span class="p">[</span><span class="s1">&#39;day&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">spc_events_proj</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;datetime_utc&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">datetime_utc</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">day</span>
<span class="n">spc_events_proj</span><span class="p">[</span><span class="s1">&#39;month&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">spc_events_proj</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;datetime_utc&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">datetime_utc</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ot_data_proj</span><span class="p">[</span><span class="s1">&#39;btd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ot_data_proj</span><span class="o">.</span><span class="n">mintb</span> <span class="o">-</span> <span class="n">ot_data_proj</span><span class="o">.</span><span class="n">tropopause_temperature</span>
<span class="n">ot_data_proj</span><span class="p">[</span><span class="s1">&#39;ot_depth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ot_data_proj</span><span class="o">.</span><span class="n">cloudtop_height</span> <span class="o">-</span> <span class="n">ot_data_proj</span><span class="o">.</span><span class="n">tropopause_height</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create lists to store dataframes</span>
<span class="n">hail_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">wind_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">torn_list</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Iterate over each day to analyze reports to remove duplicates and maximize matches</span>
<span class="k">for</span> <span class="n">month</span> <span class="ow">in</span> <span class="n">ot_data_proj</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
    <span class="n">ot_df</span> <span class="o">=</span> <span class="n">ot_data_proj</span><span class="p">[</span><span class="n">ot_data_proj</span><span class="o">.</span><span class="n">month</span> <span class="o">==</span> <span class="n">month</span><span class="p">]</span>
    <span class="n">spc_df</span> <span class="o">=</span> <span class="n">spc_events_proj</span><span class="p">[</span><span class="n">spc_events_proj</span><span class="o">.</span><span class="n">month</span> <span class="o">==</span> <span class="n">month</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">day</span> <span class="ow">in</span> <span class="n">ot_df</span><span class="o">.</span><span class="n">day</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
        <span class="n">sub_ot</span> <span class="o">=</span> <span class="n">ot_df</span><span class="p">[</span><span class="n">ot_df</span><span class="o">.</span><span class="n">day</span> <span class="o">==</span> <span class="n">day</span><span class="p">]</span>
        <span class="n">sub_spc</span> <span class="o">=</span> <span class="n">spc_df</span><span class="p">[</span><span class="n">spc_df</span><span class="o">.</span><span class="n">day</span> <span class="o">==</span> <span class="n">day</span><span class="p">]</span>
        <span class="n">hail_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">match_report</span><span class="p">(</span><span class="n">sub_spc</span><span class="p">,</span> <span class="n">sub_ot</span><span class="p">,</span> <span class="n">hazard_type</span><span class="o">=</span><span class="s1">&#39;Hail&#39;</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">45000</span><span class="p">,</span> <span class="n">time_int</span><span class="o">=</span><span class="mi">35</span><span class="p">))</span>
        <span class="n">wind_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">match_report</span><span class="p">(</span><span class="n">sub_spc</span><span class="p">,</span> <span class="n">sub_ot</span><span class="p">,</span> <span class="n">hazard_type</span><span class="o">=</span><span class="s1">&#39;Thunderstorm Wind&#39;</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">45000</span><span class="p">,</span> <span class="n">time_int</span><span class="o">=</span><span class="mi">35</span><span class="p">))</span>
        <span class="n">torn_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">match_report</span><span class="p">(</span><span class="n">sub_spc</span><span class="p">,</span> <span class="n">sub_ot</span><span class="p">,</span> <span class="n">hazard_type</span><span class="o">=</span><span class="s1">&#39;Tornado&#39;</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">45000</span><span class="p">,</span> <span class="n">time_int</span><span class="o">=</span><span class="mi">35</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/geopandas/geodataframe.py:831: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super(GeoDataFrame, self).__setitem__(key, value)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hail_matched</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">hail_list</span><span class="p">)</span>
<span class="n">wind_matched</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">wind_list</span><span class="p">)</span>
<span class="n">torn_matched</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">torn_list</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wind_matched</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;EPISODE_ID_x&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time</th>
      <th>area_polygon</th>
      <th>cloudtop_height</th>
      <th>e_radial</th>
      <th>e_radial_del2</th>
      <th>e_tb</th>
      <th>lat</th>
      <th>lat_corr</th>
      <th>lon</th>
      <th>lon_corr</th>
      <th>...</th>
      <th>EPISODE_NARRATIVE</th>
      <th>EVENT_NARRATIVE</th>
      <th>DATA_SOURCE</th>
      <th>EF_RATING</th>
      <th>datetime_utc</th>
      <th>day_right</th>
      <th>month_right</th>
      <th>haz_datetime</th>
      <th>ota_datetime</th>
      <th>abs_time_diff</th>
    </tr>
    <tr>
      <th>EPISODE_ID_x</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>146212</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>...</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>146227</th>
      <td>7</td>
      <td>7</td>
      <td>7</td>
      <td>7</td>
      <td>7</td>
      <td>7</td>
      <td>7</td>
      <td>7</td>
      <td>7</td>
      <td>7</td>
      <td>...</td>
      <td>7</td>
      <td>7</td>
      <td>7</td>
      <td>0</td>
      <td>7</td>
      <td>7</td>
      <td>7</td>
      <td>7</td>
      <td>7</td>
      <td>7</td>
    </tr>
    <tr>
      <th>146433</th>
      <td>17</td>
      <td>17</td>
      <td>17</td>
      <td>17</td>
      <td>17</td>
      <td>17</td>
      <td>17</td>
      <td>17</td>
      <td>17</td>
      <td>17</td>
      <td>...</td>
      <td>17</td>
      <td>17</td>
      <td>17</td>
      <td>0</td>
      <td>17</td>
      <td>17</td>
      <td>17</td>
      <td>17</td>
      <td>17</td>
      <td>17</td>
    </tr>
    <tr>
      <th>146436</th>
      <td>11</td>
      <td>11</td>
      <td>11</td>
      <td>11</td>
      <td>11</td>
      <td>11</td>
      <td>11</td>
      <td>11</td>
      <td>11</td>
      <td>11</td>
      <td>...</td>
      <td>11</td>
      <td>11</td>
      <td>11</td>
      <td>0</td>
      <td>11</td>
      <td>11</td>
      <td>11</td>
      <td>11</td>
      <td>11</td>
      <td>11</td>
    </tr>
    <tr>
      <th>146452</th>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>...</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>152767</th>
      <td>10</td>
      <td>10</td>
      <td>10</td>
      <td>10</td>
      <td>10</td>
      <td>10</td>
      <td>10</td>
      <td>10</td>
      <td>10</td>
      <td>10</td>
      <td>...</td>
      <td>10</td>
      <td>5</td>
      <td>10</td>
      <td>0</td>
      <td>10</td>
      <td>10</td>
      <td>10</td>
      <td>10</td>
      <td>10</td>
      <td>10</td>
    </tr>
    <tr>
      <th>152783</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>...</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>152950</th>
      <td>5</td>
      <td>5</td>
      <td>5</td>
      <td>5</td>
      <td>5</td>
      <td>5</td>
      <td>5</td>
      <td>5</td>
      <td>5</td>
      <td>5</td>
      <td>...</td>
      <td>5</td>
      <td>5</td>
      <td>5</td>
      <td>0</td>
      <td>5</td>
      <td>5</td>
      <td>5</td>
      <td>5</td>
      <td>5</td>
      <td>5</td>
    </tr>
    <tr>
      <th>153167</th>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>...</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>0</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>153180</th>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>...</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>0</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
<p>489 rows × 116 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">mean_wind</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">23</span><span class="o">-</span><span class="mi">9</span><span class="n">a009ac6a3ef</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="nb">len</span><span class="p">(</span><span class="n">mean_wind</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;mean_wind&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">wind_matched</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2862
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ot_data</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f7a0a7dbf28&gt;
</pre></div>
</div>
<img alt="_images/ot-spc-comparison_38_1.png" src="_images/ot-spc-comparison_38_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">end_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>

<span class="n">ot_sub</span> <span class="o">=</span> <span class="n">ot_data</span><span class="p">[(</span><span class="n">ot_data</span><span class="o">.</span><span class="n">time</span> <span class="o">&gt;=</span> <span class="n">start_date</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">ot_data</span><span class="o">.</span><span class="n">time</span> <span class="o">&lt;=</span> <span class="n">end_date</span><span class="p">)]</span>

<span class="n">wind_matches</span> <span class="o">=</span> <span class="n">wind_matched</span><span class="p">[(</span><span class="n">wind_matched</span><span class="o">.</span><span class="n">time</span> <span class="o">&gt;=</span> <span class="n">start_date</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">wind_matched</span><span class="o">.</span><span class="n">time</span> <span class="o">&lt;=</span> <span class="n">end_date</span><span class="p">)]</span>
<span class="n">hail_matches</span> <span class="o">=</span> <span class="n">hail_matched</span><span class="p">[(</span><span class="n">hail_matched</span><span class="o">.</span><span class="n">time</span> <span class="o">&gt;=</span> <span class="n">start_date</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">hail_matched</span><span class="o">.</span><span class="n">time</span> <span class="o">&lt;=</span> <span class="n">end_date</span><span class="p">)]</span>
<span class="n">torn_matches</span> <span class="o">=</span> <span class="n">torn_matched</span><span class="p">[(</span><span class="n">torn_matched</span><span class="o">.</span><span class="n">time</span> <span class="o">&gt;=</span> <span class="n">start_date</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">torn_matched</span><span class="o">.</span><span class="n">time</span> <span class="o">&lt;=</span> <span class="n">end_date</span><span class="p">)]</span>

<span class="n">start_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">start_date</span><span class="p">)</span><span class="o">.</span><span class="n">tz_localize</span><span class="p">(</span><span class="s1">&#39;utc&#39;</span><span class="p">)</span>
<span class="n">end_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">end_date</span><span class="p">)</span><span class="o">.</span><span class="n">tz_localize</span><span class="p">(</span><span class="s1">&#39;utc&#39;</span><span class="p">)</span>

<span class="n">spc_sub</span> <span class="o">=</span> <span class="n">spc_events</span><span class="p">[(</span><span class="n">spc_events</span><span class="o">.</span><span class="n">datetime_utc</span> <span class="o">&gt;=</span> <span class="n">start_date</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">spc_events</span><span class="o">.</span><span class="n">datetime_utc</span> <span class="o">&lt;=</span> <span class="n">end_date</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mean_hail</span> <span class="o">=</span> <span class="n">hail_matched</span><span class="p">[[</span><span class="s1">&#39;EPISODE_ID_x&#39;</span><span class="p">,</span> <span class="s1">&#39;MAGNITUDE&#39;</span><span class="p">,</span> <span class="s1">&#39;area_polygon&#39;</span><span class="p">,</span> <span class="s1">&#39;btd&#39;</span><span class="p">,</span> <span class="s1">&#39;ot_depth&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;EPISODE_ID_x&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">torn_matched</span><span class="p">[</span><span class="s1">&#39;prop_damage&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">torn_matched</span><span class="o">.</span><span class="n">DAMAGE_PROPERTY</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="s1">&#39;(\d+)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">good_tors</span> <span class="o">=</span> <span class="n">torn_matched</span><span class="p">[</span><span class="n">torn_matched</span><span class="o">.</span><span class="n">prop_damage</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>

<span class="n">torn_matched</span> <span class="o">=</span> <span class="n">good_tors</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;area_polygon&#39;</span><span class="p">,</span> <span class="s1">&#39;MAGNITUDE&#39;</span><span class="p">,</span> <span class="s1">&#39;btd&#39;</span><span class="p">,</span> <span class="s1">&#39;datetime_utc&#39;</span><span class="p">])</span>
<span class="n">mean_torn</span> <span class="o">=</span> <span class="n">good_tors</span><span class="p">[[</span><span class="s1">&#39;EPISODE_ID_y&#39;</span><span class="p">,</span> <span class="s1">&#39;MAGNITUDE&#39;</span><span class="p">,</span> <span class="s1">&#39;area_polygon&#39;</span><span class="p">,</span> <span class="s1">&#39;btd&#39;</span><span class="p">,</span> <span class="s1">&#39;TOR_WIDTH&#39;</span><span class="p">,</span> <span class="s1">&#39;ot_depth&#39;</span><span class="p">,</span> 
                       <span class="s1">&#39;datetime_utc&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;EPISODE_ID_y&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>

<span class="n">mean_torn</span><span class="p">[</span><span class="s1">&#39;round_width&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">mean_torn</span><span class="p">[</span><span class="s1">&#39;TOR_WIDTH&#39;</span><span class="p">],</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mean_hail</span><span class="p">[</span><span class="s1">&#39;round_hail&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">mean_hail</span><span class="p">[</span><span class="s1">&#39;MAGNITUDE&#39;</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
<span class="c1">#mean_hail[&#39;round_damage&#39;] = np.round(mean_hail[&#39;damage_crops&#39;], -1)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">r2_score</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">mean_hail</span><span class="o">.</span><span class="n">area_polygon</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">mean_hail</span><span class="o">.</span><span class="n">MAGNITUDE</span>

<span class="n">mymodel</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">poly1d</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">linmodel</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">poly1d</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

<span class="n">r_poly</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">mymodel</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
<span class="n">r_lin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">linmodel</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>

<span class="nb">print</span><span class="p">(</span><span class="n">r_poly</span><span class="p">,</span> <span class="n">r_lin</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.30280212646310906 0.2954531996254951
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;area_polygon&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;round_hail&#39;</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">mean_hail</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Hail (in.)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;OT Area ($km^</span><span class="si">{2}</span><span class="s1">$)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Hail Rounded to Nearest Inch&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;hail_boxplot.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ot-spc-comparison_44_0.png" src="_images/ot-spc-comparison_44_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">mean_hail</span><span class="p">[</span><span class="s1">&#39;round_hail&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">mean_hail</span><span class="p">[</span><span class="s1">&#39;MAGNITUDE&#39;</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;btd&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;round_hail&#39;</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">mean_hail</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Hail (in.)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Brightness Temperature </span><span class="se">\n</span><span class="s1"> Difference ($K$)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Hail Rounded to Nearest Inch&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;hail_boxplot_btd.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ot-spc-comparison_45_0.png" src="_images/ot-spc-comparison_45_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">mean_hail</span><span class="p">[</span><span class="s1">&#39;round_hail&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">mean_hail</span><span class="p">[</span><span class="s1">&#39;MAGNITUDE&#39;</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;ot_depth&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;round_hail&#39;</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">mean_hail</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Hail (in.)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;OT Depth ($km$)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Hail Rounded to Nearest Inch&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;hail_boxplot_otd.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="c1">#plt.savefig(&#39;hail_boxplot_may_2017.png&#39;, dpi=300)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ot-spc-comparison_46_0.png" src="_images/ot-spc-comparison_46_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;area_polygon&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;round_width&#39;</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">mean_torn</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Tornado Width (m)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;OT Area ($km^</span><span class="si">{2}</span><span class="s1">$)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Tornado Width and OTA&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="c1">#plt.savefig(&#39;tornado_width_ota.png&#39;, dpi=300)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 0.98, &#39;Tornado Width and OTA&#39;)
</pre></div>
</div>
<img alt="_images/ot-spc-comparison_47_1.png" src="_images/ot-spc-comparison_47_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;area_polygon&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;MAGNITUDE&#39;</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">mean_torn</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;EF Rating&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;OT Area ($km^</span><span class="si">{2}</span><span class="s1">$)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="p">[</span><span class="s1">&#39;EF0&#39;</span><span class="p">,</span> <span class="s1">&#39;EF1&#39;</span><span class="p">,</span> <span class="s1">&#39;EF2&#39;</span><span class="p">,</span> <span class="s1">&#39;EF3&#39;</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Tornado Intensity and OTA&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;tornado_intensity_ota.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ot-spc-comparison_48_0.png" src="_images/ot-spc-comparison_48_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">mean_torn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>16
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_scatter</span><span class="p">(</span><span class="n">mean_torn</span><span class="p">,</span> <span class="s1">&#39;Tornado Rating (EF)&#39;</span><span class="p">,</span> <span class="s1">&#39;area_polygon&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:red&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;tornado_ot_may_2017.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ot-spc-comparison_50_0.png" src="_images/ot-spc-comparison_50_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mean_hail</span><span class="p">[</span><span class="n">mean_hail</span><span class="o">.</span><span class="n">MAGNITUDE</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">][</span><span class="s1">&#39;severe_hail&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&lt; 1 inch&#39;</span>
<span class="n">mean_hail</span><span class="p">[</span><span class="n">mean_hail</span><span class="o">.</span><span class="n">MAGNITUDE</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">][</span><span class="s1">&#39;severe_hail&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&gt;= 1 inch&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/ipykernel_launcher.py:1: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  &quot;&quot;&quot;Entry point for launching an IPython kernel.
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/ipykernel_launcher.py:2: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">mean_torn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>16
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">good_tors</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>71
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mean_tor</span> <span class="o">=</span> <span class="n">torn_matched</span><span class="p">[[</span><span class="s1">&#39;EPISODE_ID_x&#39;</span><span class="p">,</span> <span class="s1">&#39;TOR_WIDTH&#39;</span><span class="p">,</span> <span class="s1">&#39;area_polygon&#39;</span><span class="p">,</span> <span class="s1">&#39;MAGNITUDE&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;EPISODE_ID_x&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="now-do-some-linear-regression-to-see-how-various-ot-characteristics-match-up-with-the-damage-reports">
<h2>Now do some linear regression to see how various OT characteristics match up with the damage reports<a class="headerlink" href="#now-do-some-linear-regression-to-see-how-various-ot-characteristics-match-up-with-the-damage-reports" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">linear_regression</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    
    <span class="c1"># Use x and y values to calculate stats</span>
    <span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">stderr</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">linregress</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    
    <span class="n">line</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;$r^</span><span class="si">{</span><span class="mi">2</span><span class="si">}</span><span class="s1">$=</span><span class="si">{</span><span class="n">r</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">, p=</span><span class="si">{</span><span class="n">p</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">, n=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span>
    
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">intercept</span> <span class="o">+</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">line</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">linear_regression</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    
    <span class="c1"># Use x and y values to calculate stats</span>
    <span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">stderr</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">linregress</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    
    <span class="n">line</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;$r^</span><span class="si">{</span><span class="mi">2</span><span class="si">}</span><span class="s1">$=</span><span class="si">{</span><span class="n">r</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">, p=</span><span class="si">{</span><span class="n">p</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">, n=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span>
    
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">intercept</span> <span class="o">+</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">line</span>

<span class="k">def</span> <span class="nf">plot_scatter</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">plot_field</span><span class="p">,</span> <span class="n">area_field</span><span class="o">=</span><span class="s1">&#39;area_polygon&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;test.png&#39;</span><span class="p">):</span>
    
    <span class="c1"># Create the plots</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="s1">&#39;col&#39;</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="s1">&#39;row&#39;</span><span class="p">)</span>
    
    <span class="c1">#if plot_field == &#39;TOR_WIDTH&#39;:</span>
    <span class="c1">#    df[&#39;MAGNITUDE&#39;] = df[&#39;TOR_WIDTH&#39;]</span>
        
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">area_polygon</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                  <span class="n">df</span><span class="o">.</span><span class="n">MAGNITUDE</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
    
    <span class="c1"># Try to run the stats for each line</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">line</span> <span class="o">=</span> <span class="n">linear_regression</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">area_field</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">MAGNITUDE</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">line</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
        
    <span class="k">except</span><span class="p">:</span>
        <span class="kc">None</span>
    
    <span class="c1"># Compare the minimum brightness temperature and magnitude of the hazard</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">btd</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                  <span class="n">df</span><span class="o">.</span><span class="n">MAGNITUDE</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
    
    <span class="k">try</span><span class="p">:</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">line</span> <span class="o">=</span> <span class="n">linear_regression</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">btd</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">MAGNITUDE</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">line</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
        
    <span class="k">except</span><span class="p">:</span>
        <span class="kc">None</span>
        
    
    <span class="c1"># Compare the OT depth and magnitude of the hazard</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">ot_depth</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                  <span class="n">df</span><span class="o">.</span><span class="n">MAGNITUDE</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
    
    <span class="k">try</span><span class="p">:</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">line</span> <span class="o">=</span> <span class="n">linear_regression</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">ot_depth</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">MAGNITUDE</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">line</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center right&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
        
    <span class="k">except</span><span class="p">:</span>
        <span class="kc">None</span>

    <span class="k">for</span> <span class="n">axs</span> <span class="ow">in</span> <span class="n">ax</span><span class="p">:</span>
        <span class="n">axs</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="s1">&#39;out&#39;</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span>
                        <span class="n">labelsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
        
    
        <span class="k">if</span> <span class="n">plot_field</span> <span class="o">==</span> <span class="s1">&#39;Tornado Rating (EF)&#39;</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="p">[</span><span class="s1">&#39;EF0&#39;</span><span class="p">,</span> <span class="s1">&#39;EF1&#39;</span><span class="p">,</span> <span class="s1">&#39;EF2&#39;</span><span class="p">,</span> <span class="s1">&#39;EF3&#39;</span><span class="p">,</span> <span class="s1">&#39;EF4&#39;</span><span class="p">,</span> <span class="s1">&#39;EF5&#39;</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
    
    <span class="c1"># Add some labels to the x-axes</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;OT Area ($km^</span><span class="si">{2}</span><span class="s1">$)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Brightness Temperature </span><span class="se">\n</span><span class="s1"> Difference (K)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;OT Depth (km)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>

    <span class="c1"># Add the y-axis label from user input</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">plot_field</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="hail-analysis">
<h3>Hail Analysis<a class="headerlink" href="#hail-analysis" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mean_hail</span> <span class="o">=</span> <span class="n">hail_matched</span><span class="p">[[</span><span class="s1">&#39;EPISODE_ID_x&#39;</span><span class="p">,</span> <span class="s1">&#39;MAGNITUDE&#39;</span><span class="p">,</span> <span class="s1">&#39;area_polygon&#39;</span><span class="p">,</span> <span class="s1">&#39;btd&#39;</span><span class="p">,</span> <span class="s1">&#39;ot_depth&#39;</span><span class="p">,</span> <span class="p">]]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;EPISODE_ID_x&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mean_hail</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MAGNITUDE</th>
      <th>area_polygon</th>
      <th>btd</th>
      <th>ot_depth</th>
    </tr>
    <tr>
      <th>EPISODE_ID_x</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>145999</th>
      <td>1.00</td>
      <td>6.795673</td>
      <td>-7.769989</td>
      <td>1.274000</td>
    </tr>
    <tr>
      <th>146116</th>
      <td>1.00</td>
      <td>83.109651</td>
      <td>-7.250000</td>
      <td>1.493000</td>
    </tr>
    <tr>
      <th>146134</th>
      <td>1.75</td>
      <td>116.261463</td>
      <td>-7.130005</td>
      <td>2.091001</td>
    </tr>
    <tr>
      <th>146227</th>
      <td>1.00</td>
      <td>174.741670</td>
      <td>-6.620010</td>
      <td>1.488000</td>
    </tr>
    <tr>
      <th>146433</th>
      <td>1.50</td>
      <td>94.358271</td>
      <td>-4.369995</td>
      <td>1.583000</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>152574</th>
      <td>1.25</td>
      <td>79.711252</td>
      <td>-6.149994</td>
      <td>1.097000</td>
    </tr>
    <tr>
      <th>152767</th>
      <td>1.00</td>
      <td>72.870243</td>
      <td>-2.720001</td>
      <td>1.074000</td>
    </tr>
    <tr>
      <th>152865</th>
      <td>1.00</td>
      <td>126.916412</td>
      <td>-2.449997</td>
      <td>0.856000</td>
    </tr>
    <tr>
      <th>153209</th>
      <td>1.00</td>
      <td>40.684277</td>
      <td>-5.350006</td>
      <td>1.026001</td>
    </tr>
    <tr>
      <th>153232</th>
      <td>1.00</td>
      <td>57.365592</td>
      <td>-6.889999</td>
      <td>1.272000</td>
    </tr>
  </tbody>
</table>
<p>282 rows × 4 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mean_hail</span> <span class="o">=</span> <span class="n">mean_hail</span><span class="p">[</span><span class="n">mean_hail</span><span class="o">.</span><span class="n">MAGNITUDE</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mean_hail</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MAGNITUDE</th>
      <th>area_polygon</th>
      <th>btd</th>
      <th>ot_depth</th>
    </tr>
    <tr>
      <th>EPISODE_ID_x</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>145999</th>
      <td>1.00</td>
      <td>6.795673</td>
      <td>-7.769989</td>
      <td>1.274000</td>
    </tr>
    <tr>
      <th>146116</th>
      <td>1.00</td>
      <td>83.109651</td>
      <td>-7.250000</td>
      <td>1.493000</td>
    </tr>
    <tr>
      <th>146134</th>
      <td>1.75</td>
      <td>116.261463</td>
      <td>-7.130005</td>
      <td>2.091001</td>
    </tr>
    <tr>
      <th>146227</th>
      <td>1.00</td>
      <td>174.741670</td>
      <td>-6.620010</td>
      <td>1.488000</td>
    </tr>
    <tr>
      <th>146433</th>
      <td>1.50</td>
      <td>94.358271</td>
      <td>-4.369995</td>
      <td>1.583000</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>152574</th>
      <td>1.25</td>
      <td>79.711252</td>
      <td>-6.149994</td>
      <td>1.097000</td>
    </tr>
    <tr>
      <th>152767</th>
      <td>1.00</td>
      <td>72.870243</td>
      <td>-2.720001</td>
      <td>1.074000</td>
    </tr>
    <tr>
      <th>152865</th>
      <td>1.00</td>
      <td>126.916412</td>
      <td>-2.449997</td>
      <td>0.856000</td>
    </tr>
    <tr>
      <th>153209</th>
      <td>1.00</td>
      <td>40.684277</td>
      <td>-5.350006</td>
      <td>1.026001</td>
    </tr>
    <tr>
      <th>153232</th>
      <td>1.00</td>
      <td>57.365592</td>
      <td>-6.889999</td>
      <td>1.272000</td>
    </tr>
  </tbody>
</table>
<p>282 rows × 4 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hail_matched_better</span> <span class="o">=</span> <span class="n">hail_matched</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;DAMAGE_PROPERTY&#39;</span><span class="p">,</span> <span class="s1">&#39;DAMAGE_CROPS&#39;</span><span class="p">])</span>
<span class="n">hail_matched_better</span> <span class="o">=</span> <span class="n">hail_matched_better</span><span class="p">[</span><span class="n">hail_matched_better</span><span class="o">.</span><span class="n">MAGNITUDE</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">]</span>

<span class="n">damage_property</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">damage_crops</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">damaging_flag</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">hail_matched_better</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">property_total</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;DAMAGE_PROPERTY&#39;</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
    <span class="n">crop_total</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;DAMAGE_CROPS&#39;</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
    
    <span class="n">damage_property</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">damage_total</span><span class="p">)</span>
    <span class="n">damage_crops</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">crop_total</span><span class="p">)</span>
    
<span class="n">hail_matched_better</span><span class="p">[</span><span class="s1">&#39;damage_property&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">damage_property</span>
<span class="n">hail_matched_better</span><span class="p">[</span><span class="s1">&#39;damage_crops&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">damage_crops</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">48</span><span class="o">-</span><span class="n">d2e83580e8d0</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span>     <span class="n">crop_total</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;DAMAGE_CROPS&#39;</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
<span class="g g-Whitespace">     </span><span class="mi">10</span> 
<span class="ne">---&gt; </span><span class="mi">11</span>     <span class="n">damage_property</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">damage_total</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">12</span>     <span class="n">damage_crops</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">crop_total</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">13</span> 

<span class="ne">NameError</span>: name &#39;damage_total&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test</span> <span class="o">=</span> <span class="n">wind_matched_better</span><span class="p">[(</span><span class="n">wind_matched_better</span><span class="o">.</span><span class="n">time</span> <span class="o">&gt;=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span> <span class="o">&amp;</span> 
                    <span class="p">(</span><span class="n">wind_matched_better</span><span class="o">.</span><span class="n">time</span> <span class="o">&lt;=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">22</span><span class="p">))]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">49</span><span class="o">-</span><span class="n">a616c03b9984</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">test</span> <span class="o">=</span> <span class="n">wind_matched_better</span><span class="p">[(</span><span class="n">wind_matched_better</span><span class="o">.</span><span class="n">time</span> <span class="o">&gt;=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span> <span class="o">&amp;</span> 
<span class="g g-Whitespace">      </span><span class="mi">2</span>                     <span class="p">(</span><span class="n">wind_matched_better</span><span class="o">.</span><span class="n">time</span> <span class="o">&lt;=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">22</span><span class="p">))]</span>

<span class="ne">NameError</span>: name &#39;wind_matched_better&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_groups</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;EPISODE_ID_x&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">50</span><span class="o">-</span><span class="n">be0abdf0b4ea</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">test_groups</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;EPISODE_ID_x&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>

<span class="ne">NameError</span>: name &#39;test&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_groups</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">51</span><span class="o">-</span><span class="n">f60e0af608cb</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">test_groups</span><span class="o">.</span><span class="n">index</span>

<span class="ne">NameError</span>: name &#39;test_groups&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_group1</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="n">test</span><span class="o">.</span><span class="n">EPISODE_ID_x</span> <span class="o">==</span> <span class="mi">151777</span><span class="p">]</span>
<span class="n">test_group2</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="n">test</span><span class="o">.</span><span class="n">EPISODE_ID_x</span> <span class="o">==</span> <span class="mi">150363</span><span class="p">]</span>
<span class="n">test_group3</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="n">test</span><span class="o">.</span><span class="n">EPISODE_ID_x</span> <span class="o">==</span> <span class="mi">151778</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">52</span><span class="o">-</span><span class="mi">83</span><span class="n">cfef1f5a20</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">test_group1</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="n">test</span><span class="o">.</span><span class="n">EPISODE_ID_x</span> <span class="o">==</span> <span class="mi">151777</span><span class="p">]</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">test_group2</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="n">test</span><span class="o">.</span><span class="n">EPISODE_ID_x</span> <span class="o">==</span> <span class="mi">150363</span><span class="p">]</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">test_group3</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="n">test</span><span class="o">.</span><span class="n">EPISODE_ID_x</span> <span class="o">==</span> <span class="mi">151778</span><span class="p">]</span>

<span class="ne">NameError</span>: name &#39;test&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>


<span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">LAND</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">STATES</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">LAKES</span><span class="p">)</span>

<span class="c1">#ax1.scatter(test_group1.lon_corr.values, test_group1.lat_corr.values, color=&#39;tab:red&#39;, s=test_group1.otarea_circle.values * 10)</span>
<span class="c1">#ax1.scatter(test_group2.lon_corr.values, test_group2.lat_corr.values, color=&#39;tab:blue&#39;, s=test_group2.otarea_circle.values * 10)</span>
<span class="n">s</span><span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">test_group3</span><span class="o">.</span><span class="n">lon_corr</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">test_group3</span><span class="o">.</span><span class="n">lat_corr</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">test_group2</span><span class="o">.</span><span class="n">otarea_circle</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">test_group2</span><span class="o">.</span><span class="n">otarea_circle</span><span class="o">.</span><span class="n">values</span> <span class="o">*</span> <span class="mi">10</span><span class="p">,</span>
            <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;magma&#39;</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Max OTA: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">test_group2</span><span class="o">.</span><span class="n">otarea_circle</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s1"> $km^</span><span class="si">{</span><span class="mi">2</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;OTA ($km^</span><span class="si">{2}</span><span class="s1">$)&#39;</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>


<span class="n">ax1</span><span class="o">.</span><span class="n">set_extent</span><span class="p">((</span><span class="o">-</span><span class="mi">94</span><span class="p">,</span> <span class="o">-</span><span class="mi">87</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">44</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;OTA from Matched Reports&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

<span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">LAND</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">STATES</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">LAKES</span><span class="p">)</span>

<span class="c1">#ax2.scatter(test_group1.BEGIN_LON.values, test_group1.BEGIN_LAT.values, color=&#39;tab:red&#39;, s=test_group1.MAGNITUDE.values * 10)</span>
<span class="c1">#ax2.scatter(test_group2.BEGIN_LON.values, test_group2.BEGIN_LAT.values, color=&#39;tab:blue&#39;, s=test_group2.MAGNITUDE.values * 10)</span>
<span class="n">s2</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">test_group3</span><span class="o">.</span><span class="n">BEGIN_LON</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">test_group3</span><span class="o">.</span><span class="n">BEGIN_LAT</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">test_group2</span><span class="o">.</span><span class="n">MAGNITUDE</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">test_group2</span><span class="o">.</span><span class="n">MAGNITUDE</span><span class="o">.</span><span class="n">values</span> <span class="o">*</span> <span class="mi">10</span><span class="p">,</span>
                 <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Max Wind Speed: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">test_group2</span><span class="o">.</span><span class="n">MAGNITUDE</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s1"> kt&#39;</span><span class="p">)</span>
<span class="n">time</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">test_group3</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1"> %b %H%M UTC&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Matched Wind Reports from </span><span class="si">{</span><span class="n">time</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">s2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Wind Speed (kt)&#39;</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Wind  from Matched Reports&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_extent</span><span class="p">((</span><span class="o">-</span><span class="mi">94</span><span class="p">,</span> <span class="o">-</span><span class="mi">87</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">44</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;Example_OT_Match.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">53</span><span class="o">-</span><span class="mi">00207</span><span class="n">a1e0ab0</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span> <span class="c1">#ax1.scatter(test_group1.lon_corr.values, test_group1.lat_corr.values, color=&#39;tab:red&#39;, s=test_group1.otarea_circle.values * 10)</span>
<span class="g g-Whitespace">     </span><span class="mi">10</span> <span class="c1">#ax1.scatter(test_group2.lon_corr.values, test_group2.lat_corr.values, color=&#39;tab:blue&#39;, s=test_group2.otarea_circle.values * 10)</span>
<span class="ne">---&gt; </span><span class="mi">11</span> <span class="n">s</span><span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">test_group3</span><span class="o">.</span><span class="n">lon_corr</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">test_group3</span><span class="o">.</span><span class="n">lat_corr</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">test_group2</span><span class="o">.</span><span class="n">otarea_circle</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">test_group2</span><span class="o">.</span><span class="n">otarea_circle</span><span class="o">.</span><span class="n">values</span> <span class="o">*</span> <span class="mi">10</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">12</span>             <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;magma&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">13</span> 

<span class="ne">NameError</span>: name &#39;test_group3&#39; is not defined
</pre></div>
</div>
<img alt="_images/ot-spc-comparison_68_1.png" src="_images/ot-spc-comparison_68_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hail_df</span> <span class="o">=</span> <span class="n">spc_events</span><span class="p">[(</span><span class="n">spc_events</span><span class="o">.</span><span class="n">time</span> <span class="o">&gt;</span> <span class="n">start_date</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">spc_events</span><span class="o">.</span><span class="n">MAGNITUDE</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">AttributeError</span><span class="g g-Whitespace">                            </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">54</span><span class="o">-</span><span class="n">db1b63cb916e</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">hail_df</span> <span class="o">=</span> <span class="n">spc_events</span><span class="p">[(</span><span class="n">spc_events</span><span class="o">.</span><span class="n">time</span> <span class="o">&gt;</span> <span class="n">start_date</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">spc_events</span><span class="o">.</span><span class="n">MAGNITUDE</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)]</span>

<span class="nn">/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/pandas/core/generic.py</span> in <span class="ni">__getattr__</span><span class="nt">(self, name)</span>
<span class="g g-Whitespace">   </span><span class="mi">5272</span>             <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_info_axis</span><span class="o">.</span><span class="n">_can_hold_identifiers_and_holds_name</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">5273</span>                 <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
<span class="ne">-&gt; </span><span class="mi">5274</span>             <span class="k">return</span> <span class="nb">object</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">5275</span> 
<span class="g g-Whitespace">   </span><span class="mi">5276</span>     <span class="k">def</span> <span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

<span class="ne">AttributeError</span>: &#39;GeoDataFrame&#39; object has no attribute &#39;time&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">hail_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">55</span><span class="o">-</span><span class="mi">491</span><span class="n">d87921ebc</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="nb">len</span><span class="p">(</span><span class="n">hail_df</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;hail_df&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">hail_matched_better</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1068
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hail_matched_better</span> <span class="o">=</span> <span class="n">hail_matched</span><span class="p">[</span><span class="n">hail_matched</span><span class="o">.</span><span class="n">MAGNITUDE</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mean_hail</span> <span class="o">=</span> <span class="n">hail_matched_better</span><span class="p">[[</span><span class="s1">&#39;EPISODE_ID_x&#39;</span><span class="p">,</span> <span class="s1">&#39;MAGNITUDE&#39;</span><span class="p">,</span> <span class="s1">&#39;area_polygon&#39;</span><span class="p">,</span> <span class="s1">&#39;btd&#39;</span><span class="p">,</span> <span class="s1">&#39;ot_depth&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;EPISODE_ID_x&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_scatter</span><span class="p">(</span><span class="n">mean_hail</span><span class="p">,</span> <span class="s1">&#39;Hail Size (in)&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:green&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Hail_OT.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ot-spc-comparison_74_0.png" src="_images/ot-spc-comparison_74_0.png" />
</div>
</div>
<p>There does not appear to be a significant relationship between OTA, minimum brightness temperature, or OT depth and hail size. The closes relationship appears to be OT depth and hail size, although the regression suggests a negative relationship such that deeper OTs have smaller hail, which would not make much physical sense since typically OT depth relates to deeper, more intense thunderstorms.</p>
</div>
<div class="section" id="wind-analysis">
<h3>Wind Analysis<a class="headerlink" href="#wind-analysis" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mean_wind</span> <span class="o">=</span> <span class="n">wind_matched</span><span class="p">[[</span><span class="s1">&#39;EPISODE_ID_x&#39;</span><span class="p">,</span> <span class="s1">&#39;MAGNITUDE&#39;</span><span class="p">,</span> <span class="s1">&#39;area_polygon&#39;</span><span class="p">,</span> <span class="s1">&#39;btd&#39;</span><span class="p">,</span> <span class="s1">&#39;ot_depth&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;EPISODE_ID_x&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mean_wind</span> <span class="o">=</span> <span class="n">mean_wind</span><span class="p">[</span><span class="n">mean_wind</span><span class="o">.</span><span class="n">MAGNITUDE</span> <span class="o">&gt;=</span> <span class="mi">50</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_scatter</span><span class="p">(</span><span class="n">mean_wind</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;area_polygon&#39;</span><span class="p">]),</span> <span class="s1">&#39;Wind Speed (kts)&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;wind_ot.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ot-spc-comparison_78_0.png" src="_images/ot-spc-comparison_78_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wind_matched_better</span> <span class="o">=</span> <span class="n">wind_matched</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;DAMAGE_PROPERTY&#39;</span><span class="p">])</span>
<span class="n">wind_matched_better</span> <span class="o">=</span> <span class="n">wind_matched_better</span><span class="p">[</span><span class="n">wind_matched_better</span><span class="o">.</span><span class="n">MAGNITUDE</span> <span class="o">&gt;=</span> <span class="mi">50</span><span class="p">]</span>

<span class="n">damage_totals</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">damaging_flag</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">wind_matched_better</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">damage_total</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;DAMAGE_PROPERTY&#39;</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
    
    <span class="k">if</span> <span class="n">damage_total</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">damaging_flag</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Damage&#39;</span><span class="p">)</span>
        
    <span class="k">else</span><span class="p">:</span>
        <span class="n">damaging_flag</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;No Damage&#39;</span><span class="p">)</span>
    
    <span class="n">damage_totals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">damage_total</span><span class="p">)</span>
    
<span class="n">wind_matched_better</span><span class="p">[</span><span class="s1">&#39;damage_total&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">damage_totals</span>
<span class="n">wind_matched_better</span><span class="p">[</span><span class="s1">&#39;damage_flag&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">damaging_flag</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wind_matched_better</span><span class="p">[</span><span class="s1">&#39;damage_total&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">damage_totals</span>
<span class="n">wind_matched_better</span><span class="p">[</span><span class="s1">&#39;damage_flag&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">damaging_flag</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mean_wind</span> <span class="o">=</span> <span class="n">wind_matched_better</span><span class="p">[[</span><span class="s1">&#39;EPISODE_ID_x&#39;</span><span class="p">,</span> <span class="s1">&#39;MAGNITUDE&#39;</span><span class="p">,</span> <span class="s1">&#39;area_polygon&#39;</span><span class="p">,</span> <span class="s1">&#39;btd&#39;</span><span class="p">,</span> <span class="s1">&#39;ot_depth&#39;</span><span class="p">,</span> <span class="s1">&#39;damage_total&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;EPISODE_ID_x&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mean_wind</span> <span class="o">=</span> <span class="n">mean_wind</span><span class="p">[</span><span class="n">mean_wind</span><span class="o">.</span><span class="n">damage_total</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mean_wind</span><span class="p">[</span><span class="s1">&#39;round_wind&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">mean_wind</span><span class="p">[</span><span class="s1">&#39;MAGNITUDE&#39;</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">mean_wind</span><span class="p">[</span><span class="s1">&#39;round_damage&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">mean_wind</span><span class="p">[</span><span class="s1">&#39;damage_total&#39;</span><span class="p">],</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">good_tors</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;EVENT_ID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time</th>
      <th>area_polygon</th>
      <th>cloudtop_height</th>
      <th>e_radial</th>
      <th>e_radial_del2</th>
      <th>e_tb</th>
      <th>lat</th>
      <th>lat_corr</th>
      <th>lon</th>
      <th>lon_corr</th>
      <th>...</th>
      <th>EVENT_NARRATIVE</th>
      <th>DATA_SOURCE</th>
      <th>EF_RATING</th>
      <th>datetime_utc</th>
      <th>day_right</th>
      <th>month_right</th>
      <th>haz_datetime</th>
      <th>ota_datetime</th>
      <th>abs_time_diff</th>
      <th>prop_damage</th>
    </tr>
    <tr>
      <th>EVENT_ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>887852</th>
      <td>2020-04-23 05:20:16</td>
      <td>49.788314</td>
      <td>15.903001</td>
      <td>2.244381</td>
      <td>[ 0.03134155  0.02655411 -0.01381302 -0.070930...</td>
      <td>[199.53114319 199.82844543 200.18843079 200.52...</td>
      <td>32.258930</td>
      <td>31.165785</td>
      <td>-90.151794</td>
      <td>-92.249496</td>
      <td>...</td>
      <td>The tornado started east of Highways 115 and 1...</td>
      <td>CSV</td>
      <td>2</td>
      <td>2020-04-23 05:08:00+00:00</td>
      <td>23</td>
      <td>4</td>
      <td>2020-04-23 05:08:00+00:00</td>
      <td>2020-04-23 05:20:16+00:00</td>
      <td>00:12:16</td>
      <td>1</td>
    </tr>
    <tr>
      <th>890616</th>
      <td>2020-04-22 20:50:16</td>
      <td>109.612339</td>
      <td>13.891001</td>
      <td>2.134019</td>
      <td>[ 0.01722717  0.01551819 -0.00487518 -0.033515...</td>
      <td>[211.97789001 212.19236755 212.44129944 212.68...</td>
      <td>36.473213</td>
      <td>34.837357</td>
      <td>-90.008934</td>
      <td>-97.519218</td>
      <td>...</td>
      <td>A tornado moved east-southeast from west of Co...</td>
      <td>CSV</td>
      <td>1</td>
      <td>2020-04-22 20:17:00+00:00</td>
      <td>22</td>
      <td>4</td>
      <td>2020-04-22 20:17:00+00:00</td>
      <td>2020-04-22 20:50:16+00:00</td>
      <td>00:33:16</td>
      <td>200</td>
    </tr>
    <tr>
      <th>890618</th>
      <td>2020-04-23 18:50:16</td>
      <td>60.255211</td>
      <td>16.285000</td>
      <td>4.547864</td>
      <td>[ 4.06433105e-01  5.54141998e-01  5.49598694e-...</td>
      <td>[203.09609985 203.03645325 203.29348755 203.80...</td>
      <td>31.116072</td>
      <td>31.009071</td>
      <td>-85.830360</td>
      <td>-85.791359</td>
      <td>...</td>
      <td>Tree damage was first noted along Bob Sikes Rd...</td>
      <td>CSV</td>
      <td>1</td>
      <td>2020-04-23 19:13:00+00:00</td>
      <td>23</td>
      <td>4</td>
      <td>2020-04-23 19:13:00+00:00</td>
      <td>2020-04-23 18:50:16+00:00</td>
      <td>00:32:44</td>
      <td>100</td>
    </tr>
    <tr>
      <th>890624</th>
      <td>2020-04-23 19:00:16</td>
      <td>57.473803</td>
      <td>15.224001</td>
      <td>5.677614</td>
      <td>[ 0.10957336  0.13928604  0.13526535  0.106216...</td>
      <td>[200.94235229 200.91075134 201.09829712 201.40...</td>
      <td>31.133928</td>
      <td>31.031929</td>
      <td>-85.723220</td>
      <td>-85.687218</td>
      <td>...</td>
      <td>Tree damage was first noted along Bob Sikes Rd...</td>
      <td>CSV</td>
      <td>1</td>
      <td>2020-04-23 19:17:00+00:00</td>
      <td>23</td>
      <td>4</td>
      <td>2020-04-23 19:17:00+00:00</td>
      <td>2020-04-23 19:00:16+00:00</td>
      <td>00:16:44</td>
      <td>100</td>
    </tr>
    <tr>
      <th>890625</th>
      <td>2020-04-23 19:20:16</td>
      <td>52.730244</td>
      <td>15.090001</td>
      <td>3.404709</td>
      <td>[ 0.16251373  0.18667221  0.09409332 -0.106498...</td>
      <td>[201.35452271 201.67565918 202.32182312 203.06...</td>
      <td>31.169643</td>
      <td>31.067644</td>
      <td>-85.383930</td>
      <td>-85.348923</td>
      <td>...</td>
      <td>Initial damage was noted near the intersection...</td>
      <td>CSV</td>
      <td>2</td>
      <td>2020-04-23 19:48:00+00:00</td>
      <td>23</td>
      <td>4</td>
      <td>2020-04-23 19:48:00+00:00</td>
      <td>2020-04-23 19:20:16+00:00</td>
      <td>00:27:44</td>
      <td>250</td>
    </tr>
    <tr>
      <th>890627</th>
      <td>2020-04-23 20:20:16</td>
      <td>47.238198</td>
      <td>15.981001</td>
      <td>4.549440</td>
      <td>[ 1.39038086e-01  1.62559509e-01  1.10893250e-...</td>
      <td>[203.39012146 203.66917419 204.22569275 204.94...</td>
      <td>31.133928</td>
      <td>31.026928</td>
      <td>-85.044650</td>
      <td>-85.011650</td>
      <td>...</td>
      <td>Initial damage was noted near the intersection...</td>
      <td>CSV</td>
      <td>2</td>
      <td>2020-04-23 20:00:00+00:00</td>
      <td>23</td>
      <td>4</td>
      <td>2020-04-23 20:00:00+00:00</td>
      <td>2020-04-23 20:20:16+00:00</td>
      <td>00:20:16</td>
      <td>250</td>
    </tr>
    <tr>
      <th>890636</th>
      <td>2020-04-23 21:50:16</td>
      <td>95.454835</td>
      <td>14.944000</td>
      <td>4.551978</td>
      <td>[ 0.17891693  0.24808884  0.24687195  0.080898...</td>
      <td>[200.34338379 200.15672302 200.32789612 200.77...</td>
      <td>30.919641</td>
      <td>30.820641</td>
      <td>-84.723220</td>
      <td>-84.601936</td>
      <td>...</td>
      <td>A tornado touched down just south of North Mon...</td>
      <td>CSV</td>
      <td>1</td>
      <td>2020-04-23 21:22:00+00:00</td>
      <td>23</td>
      <td>4</td>
      <td>2020-04-23 21:22:00+00:00</td>
      <td>2020-04-23 21:50:16+00:00</td>
      <td>00:28:16</td>
      <td>10</td>
    </tr>
    <tr>
      <th>890638</th>
      <td>2020-04-23 22:20:16</td>
      <td>63.512126</td>
      <td>16.318001</td>
      <td>5.726259</td>
      <td>[ 0.34244537  0.42861557  0.36254501  0.149528...</td>
      <td>[194.99281311 194.98974609 195.67156982 196.69...</td>
      <td>30.294641</td>
      <td>30.188641</td>
      <td>-84.741070</td>
      <td>-84.706070</td>
      <td>...</td>
      <td>A  tornado touched down just north of Wakulla ...</td>
      <td>CSV</td>
      <td>1</td>
      <td>2020-04-23 21:54:00+00:00</td>
      <td>23</td>
      <td>4</td>
      <td>2020-04-23 21:54:00+00:00</td>
      <td>2020-04-23 22:20:16+00:00</td>
      <td>00:26:16</td>
      <td>25</td>
    </tr>
    <tr>
      <th>890657</th>
      <td>2020-04-22 22:00:16</td>
      <td>58.192053</td>
      <td>14.347001</td>
      <td>5.340132</td>
      <td>[ 0.03211975  0.04621887  0.05475616  0.041900...</td>
      <td>[208.9455719  208.94169617 208.93814087 208.87...</td>
      <td>36.383930</td>
      <td>34.462357</td>
      <td>-91.383930</td>
      <td>-96.699783</td>
      <td>...</td>
      <td>This tornado moved east from south of Bromide ...</td>
      <td>CSV</td>
      <td>1</td>
      <td>2020-04-22 21:26:00+00:00</td>
      <td>22</td>
      <td>4</td>
      <td>2020-04-22 21:26:00+00:00</td>
      <td>2020-04-22 22:00:16+00:00</td>
      <td>00:34:16</td>
      <td>100</td>
    </tr>
    <tr>
      <th>895044</th>
      <td>2020-05-06 02:10:14</td>
      <td>133.052225</td>
      <td>15.086000</td>
      <td>6.873705</td>
      <td>[ 4.43557739e-01  5.52021027e-01  4.70870972e-...</td>
      <td>[210.10516357 210.28822327 210.51237488 210.74...</td>
      <td>35.026783</td>
      <td>30.796785</td>
      <td>-79.223210</td>
      <td>-93.181076</td>
      <td>...</td>
      <td>The tornado originated near Highway 171 south ...</td>
      <td>CSV</td>
      <td>1</td>
      <td>2020-05-06 01:45:00+00:00</td>
      <td>6</td>
      <td>5</td>
      <td>2020-05-06 01:45:00+00:00</td>
      <td>2020-05-06 02:10:14+00:00</td>
      <td>00:34:46</td>
      <td>250</td>
    </tr>
    <tr>
      <th>895045</th>
      <td>2020-05-06 02:20:14</td>
      <td>108.855466</td>
      <td>15.471001</td>
      <td>10.315021</td>
      <td>[ 0.61582947  0.76601028  0.56748199 -0.082790...</td>
      <td>[208.304245   208.06483459 207.88772583 207.79...</td>
      <td>35.044643</td>
      <td>30.217501</td>
      <td>-78.883934</td>
      <td>-92.820923</td>
      <td>...</td>
      <td>The tornado originated in Beauregard Parish an...</td>
      <td>CSV</td>
      <td>1</td>
      <td>2020-05-06 01:58:00+00:00</td>
      <td>6</td>
      <td>5</td>
      <td>2020-05-06 01:58:00+00:00</td>
      <td>2020-05-06 02:20:14+00:00</td>
      <td>00:27:46</td>
      <td>50</td>
    </tr>
    <tr>
      <th>899309</th>
      <td>2020-06-24 17:00:20</td>
      <td>68.264418</td>
      <td>15.936001</td>
      <td>5.721065</td>
      <td>[ 0.19979095  0.26392746  0.24338913  0.061794...</td>
      <td>[198.63331604 198.58839417 198.91156006 199.57...</td>
      <td>30.383930</td>
      <td>30.277929</td>
      <td>-89.491070</td>
      <td>-89.439072</td>
      <td>...</td>
      <td>A National Weather Service Damage Assessment T...</td>
      <td>CSV</td>
      <td>0</td>
      <td>2020-06-24 16:27:00+00:00</td>
      <td>24</td>
      <td>6</td>
      <td>2020-06-24 16:27:00+00:00</td>
      <td>2020-06-24 17:00:20+00:00</td>
      <td>00:33:20</td>
      <td>20</td>
    </tr>
    <tr>
      <th>899660</th>
      <td>2020-07-16 04:10:25</td>
      <td>76.064815</td>
      <td>17.464001</td>
      <td>5.207199</td>
      <td>[ 0.24983215  0.33726883  0.31121063  0.032993...</td>
      <td>[195.36384583 195.3074646  195.54229736 195.99...</td>
      <td>38.544643</td>
      <td>38.385643</td>
      <td>-87.741070</td>
      <td>-87.687073</td>
      <td>...</td>
      <td>The tornado damage was mainly to trees and pow...</td>
      <td>CSV</td>
      <td>1</td>
      <td>2020-07-16 03:40:00+00:00</td>
      <td>16</td>
      <td>7</td>
      <td>2020-07-16 03:40:00+00:00</td>
      <td>2020-07-16 04:10:25+00:00</td>
      <td>00:30:25</td>
      <td>80</td>
    </tr>
    <tr>
      <th>899662</th>
      <td>2020-07-16 04:10:25</td>
      <td>40.342778</td>
      <td>17.042002</td>
      <td>6.226209</td>
      <td>[ 1.69837952e-01  2.19657898e-01  2.01148987e-...</td>
      <td>[194.22984314 194.19395447 194.4977417  195.00...</td>
      <td>38.544643</td>
      <td>38.389645</td>
      <td>-87.723210</td>
      <td>-87.669212</td>
      <td>...</td>
      <td>The tornado entered from Posey County. The tor...</td>
      <td>CSV</td>
      <td>1</td>
      <td>2020-07-16 03:44:00+00:00</td>
      <td>16</td>
      <td>7</td>
      <td>2020-07-16 03:44:00+00:00</td>
      <td>2020-07-16 04:10:25+00:00</td>
      <td>00:26:25</td>
      <td>15</td>
    </tr>
    <tr>
      <th>905190</th>
      <td>2020-06-21 19:00:22</td>
      <td>37.080277</td>
      <td>14.339001</td>
      <td>3.080834</td>
      <td>[ 0.14554596  0.14853287  0.03059387 -0.169273...</td>
      <td>[204.89004517 206.07449341 207.55003357 209.03...</td>
      <td>39.294643</td>
      <td>39.145645</td>
      <td>-100.794650</td>
      <td>-100.692650</td>
      <td>...</td>
      <td>A well documented landspout tornado occurred i...</td>
      <td>CSV</td>
      <td>0</td>
      <td>2020-06-21 18:50:00+00:00</td>
      <td>21</td>
      <td>6</td>
      <td>2020-06-21 18:50:00+00:00</td>
      <td>2020-06-21 19:00:22+00:00</td>
      <td>00:10:22</td>
      <td>10</td>
    </tr>
    <tr>
      <th>905435</th>
      <td>2020-08-06 20:00:21</td>
      <td>125.567065</td>
      <td>14.666000</td>
      <td>5.198254</td>
      <td>[ 2.80319214e-01  3.67752075e-01  3.52363586e-...</td>
      <td>[208.52975464 208.35189819 208.73468018 209.46...</td>
      <td>38.419643</td>
      <td>38.289642</td>
      <td>-78.901790</td>
      <td>-78.888786</td>
      <td>...</td>
      <td>The second of two tornadoes spawned by a super...</td>
      <td>CSV</td>
      <td>0</td>
      <td>2020-08-06 19:50:00+00:00</td>
      <td>6</td>
      <td>8</td>
      <td>2020-08-06 19:50:00+00:00</td>
      <td>2020-08-06 20:00:21+00:00</td>
      <td>00:10:21</td>
      <td>50</td>
    </tr>
    <tr>
      <th>908958</th>
      <td>2020-09-03 21:30:18</td>
      <td>88.861989</td>
      <td>17.050001</td>
      <td>5.141458</td>
      <td>[ 2.19314575e-01  2.66639709e-01  1.94091797e-...</td>
      <td>[198.92353821 198.94825745 199.23805237 199.76...</td>
      <td>39.205357</td>
      <td>39.052357</td>
      <td>-76.723210</td>
      <td>-76.716209</td>
      <td>...</td>
      <td>A supercell thunderstorm tracked east across c...</td>
      <td>CSV</td>
      <td>0</td>
      <td>2020-09-03 20:57:00+00:00</td>
      <td>3</td>
      <td>9</td>
      <td>2020-09-03 20:57:00+00:00</td>
      <td>2020-09-03 21:30:18+00:00</td>
      <td>00:33:18</td>
      <td>1</td>
    </tr>
    <tr>
      <th>909501</th>
      <td>2020-08-10 20:10:22</td>
      <td>86.224567</td>
      <td>15.046000</td>
      <td>4.866396</td>
      <td>[ 0.25888824  0.2727623   0.05103302 -0.344314...</td>
      <td>[207.31738281 208.51145935 210.22331238 211.99...</td>
      <td>42.866074</td>
      <td>42.706074</td>
      <td>-88.848210</td>
      <td>-88.791214</td>
      <td>...</td>
      <td>Weak tornado started on the southeast end of G...</td>
      <td>CSV</td>
      <td>0</td>
      <td>2020-08-10 19:38:00+00:00</td>
      <td>10</td>
      <td>8</td>
      <td>2020-08-10 19:38:00+00:00</td>
      <td>2020-08-10 20:10:22+00:00</td>
      <td>00:32:22</td>
      <td>12</td>
    </tr>
    <tr>
      <th>914260</th>
      <td>2020-07-15 21:00:25</td>
      <td>79.669614</td>
      <td>16.431002</td>
      <td>5.121874</td>
      <td>[ 0.1367569   0.17186356  0.12015533 -0.051750...</td>
      <td>[199.64964294 199.97111511 200.56610107 201.30...</td>
      <td>39.473213</td>
      <td>39.318214</td>
      <td>-90.080360</td>
      <td>-90.017357</td>
      <td>...</td>
      <td>A tornado touched down 3.5 miles north-northwe...</td>
      <td>CSV</td>
      <td>0</td>
      <td>2020-07-15 20:28:00+00:00</td>
      <td>15</td>
      <td>7</td>
      <td>2020-07-15 20:28:00+00:00</td>
      <td>2020-07-15 21:00:25+00:00</td>
      <td>00:32:25</td>
      <td>10</td>
    </tr>
    <tr>
      <th>914562</th>
      <td>2020-07-21 20:30:25</td>
      <td>120.742835</td>
      <td>16.352001</td>
      <td>6.098580</td>
      <td>[-0.01319885 -0.03327179 -0.06521225 -0.049495...</td>
      <td>[201.58483887 201.91548157 202.52049255 203.14...</td>
      <td>40.008930</td>
      <td>39.852932</td>
      <td>-89.955360</td>
      <td>-89.894363</td>
      <td>...</td>
      <td>A tornado touched down 2.7 miles west-northwes...</td>
      <td>CSV</td>
      <td>1</td>
      <td>2020-07-21 20:05:00+00:00</td>
      <td>21</td>
      <td>7</td>
      <td>2020-07-21 20:05:00+00:00</td>
      <td>2020-07-21 20:30:25+00:00</td>
      <td>00:25:25</td>
      <td>300</td>
    </tr>
    <tr>
      <th>914976</th>
      <td>2020-08-10 02:30:22</td>
      <td>63.138785</td>
      <td>14.396001</td>
      <td>5.395766</td>
      <td>[ 0.01819611  0.02220917  0.01774979  0.005603...</td>
      <td>[207.90582275 207.93264771 207.99586487 208.07...</td>
      <td>47.366070</td>
      <td>46.239643</td>
      <td>-88.241070</td>
      <td>-88.451935</td>
      <td>...</td>
      <td>At least 50 to 100 healthy softwood and hardwo...</td>
      <td>CSV</td>
      <td>1</td>
      <td>2020-08-10 01:56:00+00:00</td>
      <td>10</td>
      <td>8</td>
      <td>2020-08-10 01:56:00+00:00</td>
      <td>2020-08-10 02:30:22+00:00</td>
      <td>00:34:22</td>
      <td>100</td>
    </tr>
    <tr>
      <th>917723</th>
      <td>2020-08-16 19:10:20</td>
      <td>63.645192</td>
      <td>15.418001</td>
      <td>5.372391</td>
      <td>[-0.00656891  0.01740265  0.10654831  0.233322...</td>
      <td>[203.57392883 203.0609436  202.53482056 202.10...</td>
      <td>36.080360</td>
      <td>35.905643</td>
      <td>-100.758934</td>
      <td>-100.655937</td>
      <td>...</td>
      <td>The tornado did minor damage around a residenc...</td>
      <td>CSV</td>
      <td>1</td>
      <td>2020-08-16 18:46:00+00:00</td>
      <td>16</td>
      <td>8</td>
      <td>2020-08-16 18:46:00+00:00</td>
      <td>2020-08-16 19:10:20+00:00</td>
      <td>00:24:20</td>
      <td>90</td>
    </tr>
    <tr>
      <th>921577</th>
      <td>2020-09-16 23:00:15</td>
      <td>73.286351</td>
      <td>17.111000</td>
      <td>4.546169</td>
      <td>[ 0.20102692  0.26005173  0.23448563  0.083328...</td>
      <td>[193.48060608 193.73654175 194.39453125 195.28...</td>
      <td>31.026787</td>
      <td>30.913786</td>
      <td>-82.187500</td>
      <td>-82.160500</td>
      <td>...</td>
      <td>Numerous gravestones were lofted and displaced...</td>
      <td>CSV</td>
      <td>1</td>
      <td>2020-09-16 22:33:00+00:00</td>
      <td>16</td>
      <td>9</td>
      <td>2020-09-16 22:33:00+00:00</td>
      <td>2020-09-16 23:00:15+00:00</td>
      <td>00:27:15</td>
      <td>40</td>
    </tr>
    <tr>
      <th>922293</th>
      <td>2020-09-17 18:10:21</td>
      <td>57.927327</td>
      <td>17.585001</td>
      <td>4.395464</td>
      <td>[ 0.34511566  0.47982025  0.51411819  0.269786...</td>
      <td>[196.30297852 197.00596619 198.02220154 199.03...</td>
      <td>34.133930</td>
      <td>34.006931</td>
      <td>-80.133934</td>
      <td>-80.114937</td>
      <td>...</td>
      <td>The tornado was first observed by the public t...</td>
      <td>CSV</td>
      <td>0</td>
      <td>2020-09-17 17:45:00+00:00</td>
      <td>17</td>
      <td>9</td>
      <td>2020-09-17 17:45:00+00:00</td>
      <td>2020-09-17 18:10:21+00:00</td>
      <td>00:25:21</td>
      <td>50</td>
    </tr>
    <tr>
      <th>922294</th>
      <td>2020-09-17 18:30:21</td>
      <td>79.640596</td>
      <td>17.157001</td>
      <td>5.492121</td>
      <td>[ 0.24045563  0.31150055  0.29381561  0.139644...</td>
      <td>[194.78633118 194.93785095 195.57028198 196.48...</td>
      <td>34.098213</td>
      <td>33.970215</td>
      <td>-80.062500</td>
      <td>-80.043503</td>
      <td>...</td>
      <td>The tornado touched down in the wooded area ju...</td>
      <td>CSV</td>
      <td>0</td>
      <td>2020-09-17 18:21:00+00:00</td>
      <td>17</td>
      <td>9</td>
      <td>2020-09-17 18:21:00+00:00</td>
      <td>2020-09-17 18:30:21+00:00</td>
      <td>00:09:21</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>25 rows × 116 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;area_polygon&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;round_wind&#39;</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">mean_wind</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Peak Wind Speed (kt)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;OT Area ($km^</span><span class="si">{2}</span><span class="s1">$)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Peak Wind Speed and OTA&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;wind_speed_ota_box.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ot-spc-comparison_85_0.png" src="_images/ot-spc-comparison_85_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;area_polygon&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;round_damage&#39;</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">mean_wind</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Damage (Thousands $)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;OT Area ($km^</span><span class="si">{2}</span><span class="s1">$)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Damage Cost and OTA&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;wind_damage_ota_box.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ot-spc-comparison_86_0.png" src="_images/ot-spc-comparison_86_0.png" />
</div>
</div>
<p>There appears to be a statistically significant relationship between minimum brightness temperature and maximum wind speed within SPC wind reports. Cooler minimum brightness temperatures (colder clouds) are related to stronger winds, which would make physical sense since previous studies show that cooler cloud top tempertaures can be related to stronger vertical wind speeds. There is not a relationship between maximum wind speed OTA or OT depth.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tor_df</span> <span class="o">=</span> <span class="n">spc_events</span><span class="p">[(</span><span class="n">spc_events</span><span class="o">.</span><span class="n">BEGIN_DATE_TIME</span> <span class="o">&gt;=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">spc_events</span><span class="o">.</span><span class="n">EVENT_TYPE</span> <span class="o">==</span> <span class="s1">&#39;Tornado&#39;</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tor_df</span> <span class="o">=</span> <span class="n">spc_sub</span><span class="p">[</span><span class="n">spc_sub</span><span class="o">.</span><span class="n">EVENT_TYPE</span> <span class="o">==</span> <span class="s1">&#39;Tornado&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tor_df</span> <span class="o">=</span> <span class="n">tor_df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;DAMAGE_PROPERTY&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">damage_totals</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">tor_df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">damage_totals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;DAMAGE_PROPERTY&#39;</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">])))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tor_df</span><span class="p">[</span><span class="s1">&#39;damage_total&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">damage_totals</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">tor_df</span><span class="p">[</span><span class="n">tor_df</span><span class="o">.</span><span class="n">damage_total</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>510
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">torn_matched</span> <span class="o">=</span> <span class="n">torn_matched</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span> <span class="o">=</span><span class="p">[</span><span class="s1">&#39;DAMAGE_PROPERTY&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">damage_totals</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">torn_matched</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">damage_totals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;DAMAGE_PROPERTY&#39;</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">])))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">torn_matched</span><span class="p">[</span><span class="s1">&#39;damage_amt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">damage_totals</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">good_tors</span> <span class="o">=</span> <span class="n">torn_matched</span><span class="p">[</span><span class="n">torn_matched</span><span class="o">.</span><span class="n">damage_amt</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">torn_matched</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>71
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">torn_matched</span> <span class="o">=</span> <span class="n">good_tors</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;area_polygon&#39;</span><span class="p">,</span> <span class="s1">&#39;MAGNITUDE&#39;</span><span class="p">,</span> <span class="s1">&#39;btd&#39;</span><span class="p">])</span>
<span class="n">mean_torn</span> <span class="o">=</span> <span class="n">good_tors</span><span class="p">[[</span><span class="s1">&#39;EPISODE_ID_y&#39;</span><span class="p">,</span> <span class="s1">&#39;MAGNITUDE&#39;</span><span class="p">,</span> <span class="s1">&#39;area_polygon&#39;</span><span class="p">,</span> <span class="s1">&#39;btd&#39;</span><span class="p">,</span> <span class="s1">&#39;ot_depth&#39;</span><span class="p">,</span> <span class="s1">&#39;TOR_WIDTH&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;EPISODE_ID_y&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mean_torn</span><span class="p">[</span><span class="s1">&#39;round_width&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">mean_torn</span><span class="p">[</span><span class="s1">&#39;TOR_WIDTH&#39;</span><span class="p">],</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mean_torn</span><span class="p">[</span><span class="n">mean_torn</span><span class="o">.</span><span class="n">round_width</span> <span class="o">==</span> <span class="mi">100</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MAGNITUDE</th>
      <th>area_polygon</th>
      <th>btd</th>
      <th>ot_depth</th>
      <th>TOR_WIDTH</th>
      <th>round_width</th>
    </tr>
    <tr>
      <th>EPISODE_ID_y</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>147470</th>
      <td>2.0</td>
      <td>49.788314</td>
      <td>-7.270004</td>
      <td>1.389000</td>
      <td>100.0</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>148570</th>
      <td>1.0</td>
      <td>133.052225</td>
      <td>-0.320007</td>
      <td>1.757000</td>
      <td>75.0</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>149262</th>
      <td>1.0</td>
      <td>76.064815</td>
      <td>-7.260010</td>
      <td>2.159000</td>
      <td>80.0</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>149498</th>
      <td>0.0</td>
      <td>125.567065</td>
      <td>-6.089996</td>
      <td>0.896999</td>
      <td>75.0</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>149578</th>
      <td>0.0</td>
      <td>37.080277</td>
      <td>-7.690002</td>
      <td>1.114000</td>
      <td>100.0</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>150772</th>
      <td>0.0</td>
      <td>88.861989</td>
      <td>-5.009995</td>
      <td>1.449000</td>
      <td>100.0</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>151820</th>
      <td>1.0</td>
      <td>120.742835</td>
      <td>-5.840012</td>
      <td>1.644000</td>
      <td>100.0</td>
      <td>100.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mean_torn</span><span class="p">[</span><span class="n">mean_torn</span><span class="o">.</span><span class="n">round_width</span> <span class="o">==</span> <span class="mi">600</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MAGNITUDE</th>
      <th>area_polygon</th>
      <th>btd</th>
      <th>ot_depth</th>
      <th>TOR_WIDTH</th>
      <th>round_width</th>
    </tr>
    <tr>
      <th>EPISODE_ID_y</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>147030</th>
      <td>1.0</td>
      <td>109.612339</td>
      <td>-6.220001</td>
      <td>1.323001</td>
      <td>600.0</td>
      <td>600.0</td>
    </tr>
    <tr>
      <th>147391</th>
      <td>2.0</td>
      <td>95.454835</td>
      <td>-4.659988</td>
      <td>2.320000</td>
      <td>600.0</td>
      <td>600.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;area_polygon&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;round_width&#39;</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">mean_torn</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Tornado Width (m)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;OT Area ($km^</span><span class="si">{2}</span><span class="s1">$)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Tornado Width and OTA&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;tornado_width_ota.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ot-spc-comparison_103_0.png" src="_images/ot-spc-comparison_103_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;area_polygon&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;MAGNITUDE&#39;</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">mean_torn</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;EF Rating&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;OT Area ($km^</span><span class="si">{2}</span><span class="s1">$)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Tornado Intensity and OTA&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;tornado_intensity_ota.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ot-spc-comparison_104_0.png" src="_images/ot-spc-comparison_104_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">mean_torn</span><span class="o">.</span><span class="n">TOR_WIDTH</span><span class="p">,</span> <span class="n">mean_torn</span><span class="o">.</span><span class="n">area_polygon</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.PathCollection at 0x7f7a4c30f2b0&gt;
</pre></div>
</div>
<img alt="_images/ot-spc-comparison_105_1.png" src="_images/ot-spc-comparison_105_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mean_tor</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MAGNITUDE</th>
      <th>area_polygon</th>
      <th>mintb</th>
      <th>ot_depth</th>
    </tr>
    <tr>
      <th>EPISODE_ID_x</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>145999</th>
      <td>1.000000</td>
      <td>6.795673</td>
      <td>208.029999</td>
      <td>1.274000</td>
    </tr>
    <tr>
      <th>146116</th>
      <td>0.916667</td>
      <td>58.294339</td>
      <td>209.413328</td>
      <td>1.446833</td>
    </tr>
    <tr>
      <th>146133</th>
      <td>0.772727</td>
      <td>42.057688</td>
      <td>204.244542</td>
      <td>1.671273</td>
    </tr>
    <tr>
      <th>146134</th>
      <td>1.750000</td>
      <td>89.187768</td>
      <td>204.741661</td>
      <td>1.529333</td>
    </tr>
    <tr>
      <th>146227</th>
      <td>0.934737</td>
      <td>64.544175</td>
      <td>211.203152</td>
      <td>1.276158</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>152413</th>
      <td>2.166667</td>
      <td>79.337420</td>
      <td>205.919998</td>
      <td>0.945667</td>
    </tr>
    <tr>
      <th>152414</th>
      <td>1.750000</td>
      <td>53.069229</td>
      <td>200.740904</td>
      <td>1.241546</td>
    </tr>
    <tr>
      <th>152424</th>
      <td>1.000000</td>
      <td>31.562629</td>
      <td>205.589996</td>
      <td>0.947001</td>
    </tr>
    <tr>
      <th>152574</th>
      <td>1.250000</td>
      <td>79.711252</td>
      <td>202.899994</td>
      <td>1.097000</td>
    </tr>
    <tr>
      <th>152767</th>
      <td>1.000000</td>
      <td>84.206579</td>
      <td>203.264992</td>
      <td>0.588500</td>
    </tr>
  </tbody>
</table>
<p>350 rows × 4 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mean_torn</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MAGNITUDE</th>
      <th>area_polygon</th>
      <th>btd</th>
      <th>TOR_WIDTH</th>
      <th>ot_depth</th>
      <th>datetime_utc</th>
      <th>round_width</th>
    </tr>
    <tr>
      <th>EPISODE_ID_y</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>147030</th>
      <td>1.0</td>
      <td>109.612339</td>
      <td>-6.220001</td>
      <td>600.0</td>
      <td>1.323001</td>
      <td>2020-04-22 21:26:00+00:00</td>
      <td>600.0</td>
    </tr>
    <tr>
      <th>147391</th>
      <td>2.0</td>
      <td>95.454835</td>
      <td>-4.659988</td>
      <td>600.0</td>
      <td>2.320000</td>
      <td>2020-04-23 21:54:00+00:00</td>
      <td>600.0</td>
    </tr>
    <tr>
      <th>147470</th>
      <td>2.0</td>
      <td>49.788314</td>
      <td>-7.270004</td>
      <td>100.0</td>
      <td>1.389000</td>
      <td>2020-04-23 05:08:00+00:00</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>148570</th>
      <td>1.0</td>
      <td>133.052225</td>
      <td>-0.320007</td>
      <td>75.0</td>
      <td>1.757000</td>
      <td>2020-05-06 01:58:00+00:00</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>149186</th>
      <td>0.0</td>
      <td>68.264418</td>
      <td>-5.020004</td>
      <td>40.0</td>
      <td>1.045000</td>
      <td>2020-06-24 16:27:00+00:00</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>149262</th>
      <td>1.0</td>
      <td>76.064815</td>
      <td>-7.260010</td>
      <td>80.0</td>
      <td>2.159000</td>
      <td>2020-07-16 03:44:00+00:00</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>149498</th>
      <td>0.0</td>
      <td>125.567065</td>
      <td>-6.089996</td>
      <td>75.0</td>
      <td>0.896999</td>
      <td>2020-08-06 19:50:00+00:00</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>149578</th>
      <td>0.0</td>
      <td>37.080277</td>
      <td>-7.690002</td>
      <td>100.0</td>
      <td>1.114000</td>
      <td>2020-06-21 18:50:00+00:00</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>149587</th>
      <td>0.0</td>
      <td>86.224567</td>
      <td>-7.889999</td>
      <td>50.0</td>
      <td>1.474000</td>
      <td>2020-08-10 19:38:00+00:00</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>150772</th>
      <td>0.0</td>
      <td>88.861989</td>
      <td>-5.009995</td>
      <td>100.0</td>
      <td>1.449000</td>
      <td>2020-09-03 20:57:00+00:00</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>151094</th>
      <td>1.0</td>
      <td>63.138785</td>
      <td>-5.110001</td>
      <td>250.0</td>
      <td>0.752000</td>
      <td>2020-08-10 01:56:00+00:00</td>
      <td>200.0</td>
    </tr>
    <tr>
      <th>151741</th>
      <td>0.0</td>
      <td>79.669614</td>
      <td>-3.730011</td>
      <td>50.0</td>
      <td>1.000001</td>
      <td>2020-07-15 20:28:00+00:00</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>151820</th>
      <td>1.0</td>
      <td>120.742835</td>
      <td>-5.840012</td>
      <td>100.0</td>
      <td>1.644000</td>
      <td>2020-07-21 20:05:00+00:00</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>152365</th>
      <td>1.0</td>
      <td>63.645192</td>
      <td>-5.500000</td>
      <td>200.0</td>
      <td>1.768001</td>
      <td>2020-08-16 18:46:00+00:00</td>
      <td>200.0</td>
    </tr>
    <tr>
      <th>153028</th>
      <td>1.0</td>
      <td>73.286351</td>
      <td>-4.679993</td>
      <td>200.0</td>
      <td>0.782999</td>
      <td>2020-09-16 22:33:00+00:00</td>
      <td>200.0</td>
    </tr>
    <tr>
      <th>153169</th>
      <td>0.0</td>
      <td>79.640596</td>
      <td>-4.160004</td>
      <td>25.0</td>
      <td>1.396000</td>
      <td>2020-09-17 18:21:00+00:00</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_scatter</span><span class="p">(</span><span class="n">mean_torn</span><span class="p">,</span> <span class="s1">&#39;Tornado Rating (EF)&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:red&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;tornado_ot.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ot-spc-comparison_108_0.png" src="_images/ot-spc-comparison_108_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_scatter</span><span class="p">(</span><span class="n">mean_torn</span><span class="p">,</span> <span class="s1">&#39;TOR_WIDTH&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:red&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;tornado_ot.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ot-spc-comparison_109_0.png" src="_images/ot-spc-comparison_109_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Unfortunately, there were not enough data points with tornadoes in this case study to analyze the statistical difference with OT characteristics.</p>
<hr class="docutils" />
</div>
</div>
</div>
<div class="section" id="plot-5x5-degree-grid-boxes">
<h1>Plot 5x5 degree grid boxes<a class="headerlink" href="#plot-5x5-degree-grid-boxes" title="Permalink to this headline">¶</a></h1>
<p>As in Liu and Zipser (2005), we look at 5 x 5 degree heatmaps of OT characteristics to look at trends. The points are binned into lat/lon boxes, then averages, maxima, and counts are collected. Results are mapped to look at spatial trends.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_boxes</span><span class="p">(</span><span class="n">min_lon</span><span class="o">=-</span><span class="mi">105</span><span class="p">,</span> <span class="n">max_lon</span><span class="o">=-</span><span class="mi">65</span><span class="p">,</span>
               <span class="n">min_lat</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">max_lat</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">deg_spacing</span><span class="o">=</span><span class="mf">5.</span><span class="p">):</span>
    
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plots grid boxes using bounds and degree spacing parameter</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># Create lists with lon and lat values</span>
    <span class="n">lon_boxes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">min_lon</span><span class="p">,</span> <span class="n">max_lon</span><span class="p">,</span> <span class="n">deg_spacing</span><span class="p">)</span>
    <span class="n">lat_boxes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">min_lat</span><span class="p">,</span> <span class="n">max_lat</span><span class="p">,</span> <span class="n">deg_spacing</span><span class="p">)</span>
    
    <span class="c1"># Create lists to store polygon list, middle latitude, and middle longitude</span>
    <span class="n">poly_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">mid_lat</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">mid_lon</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="c1"># Loop through and create lat/lon boxes every x degrees</span>
    <span class="k">for</span> <span class="n">lat</span> <span class="ow">in</span> <span class="n">lat_boxes</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">lon</span> <span class="ow">in</span> <span class="n">lon_boxes</span><span class="p">:</span>
            
            <span class="c1"># Top left corner</span>
            <span class="n">ullon</span> <span class="o">=</span> <span class="n">lon</span>
            <span class="n">ullat</span> <span class="o">=</span> <span class="n">lat</span> <span class="o">+</span> <span class="n">deg_spacing</span>
            
            <span class="c1"># Top right corner</span>
            <span class="n">urlon</span> <span class="o">=</span> <span class="n">lon</span> <span class="o">+</span> <span class="n">deg_spacing</span>
            <span class="n">urlat</span> <span class="o">=</span> <span class="n">lat</span> <span class="o">+</span> <span class="n">deg_spacing</span>

            <span class="c1"># Bottom left corner</span>
            <span class="n">lllon</span> <span class="o">=</span> <span class="n">lon</span>
            <span class="n">lllat</span> <span class="o">=</span> <span class="n">lat</span>

            <span class="c1"># Bottom right corner</span>
            <span class="n">lrlon</span> <span class="o">=</span> <span class="n">lon</span> <span class="o">+</span> <span class="n">deg_spacing</span>
            <span class="n">lrlat</span> <span class="o">=</span> <span class="n">lat</span>
        
            <span class="c1"># Log the middle lat and lon values</span>
            <span class="n">mid_lat</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lat</span> <span class="o">+</span> <span class="p">(</span><span class="n">deg_spacing</span><span class="o">/</span><span class="mf">2.</span><span class="p">))</span>
            <span class="n">mid_lon</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lon</span> <span class="o">+</span> <span class="p">(</span><span class="n">deg_spacing</span><span class="o">/</span><span class="mf">2.</span><span class="p">))</span>
            
            <span class="c1"># Create a shapely polygon and append it to the list</span>
            <span class="n">poly_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">shapely</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">Polygon</span><span class="p">(((</span><span class="n">ullon</span><span class="p">,</span> <span class="n">ullat</span><span class="p">),</span>
                                      <span class="p">(</span><span class="n">urlon</span><span class="p">,</span> <span class="n">urlat</span><span class="p">),</span>
                                      <span class="p">(</span><span class="n">lrlon</span><span class="p">,</span> <span class="n">lrlat</span><span class="p">),</span>
                                      <span class="p">(</span><span class="n">lllon</span><span class="p">,</span> <span class="n">lllat</span><span class="p">))))</span>
            
    <span class="c1"># Return a geodataframe with polygons with middle of box lats/lons</span>
    <span class="k">return</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">({</span><span class="s1">&#39;mid_lon&#39;</span><span class="p">:</span><span class="n">mid_lon</span><span class="p">,</span>
                             <span class="s1">&#39;mid_lat&#39;</span><span class="p">:</span><span class="n">mid_lat</span><span class="p">},</span>
                              <span class="n">geometry</span><span class="o">=</span><span class="n">poly_list</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="s2">&quot;EPSG:4326&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">start_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">start_date</span><span class="p">)</span><span class="o">.</span><span class="n">tz_localize</span><span class="p">(</span><span class="s1">&#39;utc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rel_spc_events</span> <span class="o">=</span> <span class="n">spc_events</span><span class="p">[</span><span class="n">spc_events</span><span class="o">.</span><span class="n">datetime_utc</span> <span class="o">&gt;=</span> <span class="n">start_date</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hail_matched</span><span class="p">[</span><span class="n">hail_matched</span><span class="o">.</span><span class="n">MAGNITUDE</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time</th>
      <th>area_polygon</th>
      <th>cloudtop_height</th>
      <th>e_radial</th>
      <th>e_radial_del2</th>
      <th>e_tb</th>
      <th>lat</th>
      <th>lat_corr</th>
      <th>lon</th>
      <th>lon_corr</th>
      <th>...</th>
      <th>EPISODE_NARRATIVE</th>
      <th>EVENT_NARRATIVE</th>
      <th>DATA_SOURCE</th>
      <th>EF_RATING</th>
      <th>datetime_utc</th>
      <th>day_right</th>
      <th>month_right</th>
      <th>haz_datetime</th>
      <th>ota_datetime</th>
      <th>abs_time_diff</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>28572</th>
      <td>2020-07-20 01:10:26</td>
      <td>74.064903</td>
      <td>14.637001</td>
      <td>5.787165</td>
      <td>[ 0.14334869  0.21454239  0.27547836  0.234977...</td>
      <td>[205.03457642 205.25453186 205.76118469 206.55...</td>
      <td>43.383926</td>
      <td>43.195927</td>
      <td>-105.04464</td>
      <td>-104.907639</td>
      <td>...</td>
      <td>Very large hail reported with severe thunderst...</td>
      <td>NaN</td>
      <td>CSV</td>
      <td>NaN</td>
      <td>2020-07-20 00:45:00+00:00</td>
      <td>20</td>
      <td>7</td>
      <td>2020-07-20 00:45:00+00:00</td>
      <td>2020-07-20 01:10:26+00:00</td>
      <td>00:25:26</td>
    </tr>
    <tr>
      <th>48890</th>
      <td>2020-08-27 00:20:20</td>
      <td>78.146912</td>
      <td>15.589001</td>
      <td>3.828216</td>
      <td>[ 0.17086029  0.23066711  0.22599411  0.082199...</td>
      <td>[205.26055908 205.54760742 206.17637634 207.04...</td>
      <td>43.866070</td>
      <td>43.670071</td>
      <td>-101.45536</td>
      <td>-101.330360</td>
      <td>...</td>
      <td>A supercell thunderstorm developed over wester...</td>
      <td>Very large hail broke the windshield of a law ...</td>
      <td>CSV</td>
      <td>NaN</td>
      <td>2020-08-27 00:00:00+00:00</td>
      <td>27</td>
      <td>8</td>
      <td>2020-08-27 00:00:00+00:00</td>
      <td>2020-08-27 00:20:20+00:00</td>
      <td>00:20:20</td>
    </tr>
  </tbody>
</table>
<p>2 rows × 117 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rel_spc_events</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;EVENT_TYPE&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>YEARMONTH</th>
      <th>EPISODE_ID_x</th>
      <th>EVENT_ID</th>
      <th>LOCATION_INDEX</th>
      <th>RANGE</th>
      <th>AZIMUTH</th>
      <th>LOCATION</th>
      <th>LATITUDE</th>
      <th>LONGITUDE</th>
      <th>LAT2</th>
      <th>...</th>
      <th>END_LOCATION</th>
      <th>BEGIN_LAT</th>
      <th>BEGIN_LON</th>
      <th>END_LAT</th>
      <th>END_LON</th>
      <th>EPISODE_NARRATIVE</th>
      <th>EVENT_NARRATIVE</th>
      <th>DATA_SOURCE</th>
      <th>EF_RATING</th>
      <th>datetime_utc</th>
    </tr>
    <tr>
      <th>EVENT_TYPE</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Debris Flow</th>
      <td>191</td>
      <td>191</td>
      <td>191</td>
      <td>191</td>
      <td>191</td>
      <td>191</td>
      <td>191</td>
      <td>191</td>
      <td>191</td>
      <td>191</td>
      <td>...</td>
      <td>191</td>
      <td>191</td>
      <td>191</td>
      <td>191</td>
      <td>191</td>
      <td>191</td>
      <td>191</td>
      <td>191</td>
      <td>0</td>
      <td>191</td>
    </tr>
    <tr>
      <th>Dust Devil</th>
      <td>5</td>
      <td>5</td>
      <td>5</td>
      <td>5</td>
      <td>5</td>
      <td>5</td>
      <td>5</td>
      <td>5</td>
      <td>5</td>
      <td>5</td>
      <td>...</td>
      <td>5</td>
      <td>5</td>
      <td>5</td>
      <td>5</td>
      <td>5</td>
      <td>5</td>
      <td>5</td>
      <td>5</td>
      <td>0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>Flash Flood</th>
      <td>8380</td>
      <td>8380</td>
      <td>8380</td>
      <td>8380</td>
      <td>8380</td>
      <td>8380</td>
      <td>8380</td>
      <td>8380</td>
      <td>8380</td>
      <td>8380</td>
      <td>...</td>
      <td>8380</td>
      <td>8380</td>
      <td>8380</td>
      <td>8380</td>
      <td>8380</td>
      <td>8380</td>
      <td>8367</td>
      <td>8380</td>
      <td>0</td>
      <td>8380</td>
    </tr>
    <tr>
      <th>Flood</th>
      <td>4834</td>
      <td>4834</td>
      <td>4834</td>
      <td>4834</td>
      <td>4834</td>
      <td>4834</td>
      <td>4834</td>
      <td>4834</td>
      <td>4834</td>
      <td>4834</td>
      <td>...</td>
      <td>4834</td>
      <td>4834</td>
      <td>4834</td>
      <td>4834</td>
      <td>4834</td>
      <td>4834</td>
      <td>4596</td>
      <td>4834</td>
      <td>0</td>
      <td>4834</td>
    </tr>
    <tr>
      <th>Funnel Cloud</th>
      <td>220</td>
      <td>220</td>
      <td>220</td>
      <td>220</td>
      <td>220</td>
      <td>220</td>
      <td>220</td>
      <td>220</td>
      <td>220</td>
      <td>220</td>
      <td>...</td>
      <td>220</td>
      <td>220</td>
      <td>220</td>
      <td>220</td>
      <td>220</td>
      <td>220</td>
      <td>166</td>
      <td>220</td>
      <td>0</td>
      <td>220</td>
    </tr>
    <tr>
      <th>Hail</th>
      <td>5618</td>
      <td>5618</td>
      <td>5618</td>
      <td>5618</td>
      <td>5618</td>
      <td>5618</td>
      <td>5618</td>
      <td>5618</td>
      <td>5618</td>
      <td>5618</td>
      <td>...</td>
      <td>5618</td>
      <td>5618</td>
      <td>5618</td>
      <td>5618</td>
      <td>5618</td>
      <td>5618</td>
      <td>2717</td>
      <td>5618</td>
      <td>0</td>
      <td>5618</td>
    </tr>
    <tr>
      <th>Heavy Rain</th>
      <td>908</td>
      <td>908</td>
      <td>908</td>
      <td>908</td>
      <td>908</td>
      <td>908</td>
      <td>908</td>
      <td>908</td>
      <td>908</td>
      <td>908</td>
      <td>...</td>
      <td>908</td>
      <td>908</td>
      <td>908</td>
      <td>908</td>
      <td>908</td>
      <td>908</td>
      <td>852</td>
      <td>908</td>
      <td>0</td>
      <td>908</td>
    </tr>
    <tr>
      <th>Lightning</th>
      <td>182</td>
      <td>182</td>
      <td>182</td>
      <td>182</td>
      <td>182</td>
      <td>182</td>
      <td>182</td>
      <td>182</td>
      <td>182</td>
      <td>182</td>
      <td>...</td>
      <td>182</td>
      <td>182</td>
      <td>182</td>
      <td>182</td>
      <td>182</td>
      <td>182</td>
      <td>182</td>
      <td>182</td>
      <td>0</td>
      <td>182</td>
    </tr>
    <tr>
      <th>Marine Hail</th>
      <td>11</td>
      <td>11</td>
      <td>11</td>
      <td>11</td>
      <td>11</td>
      <td>11</td>
      <td>11</td>
      <td>11</td>
      <td>11</td>
      <td>11</td>
      <td>...</td>
      <td>11</td>
      <td>11</td>
      <td>11</td>
      <td>11</td>
      <td>11</td>
      <td>11</td>
      <td>11</td>
      <td>11</td>
      <td>0</td>
      <td>11</td>
    </tr>
    <tr>
      <th>Marine High Wind</th>
      <td>14</td>
      <td>14</td>
      <td>14</td>
      <td>14</td>
      <td>14</td>
      <td>14</td>
      <td>14</td>
      <td>14</td>
      <td>14</td>
      <td>14</td>
      <td>...</td>
      <td>14</td>
      <td>14</td>
      <td>14</td>
      <td>14</td>
      <td>14</td>
      <td>14</td>
      <td>14</td>
      <td>14</td>
      <td>0</td>
      <td>14</td>
    </tr>
    <tr>
      <th>Marine Strong Wind</th>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>...</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>Marine Thunderstorm Wind</th>
      <td>1846</td>
      <td>1846</td>
      <td>1846</td>
      <td>1846</td>
      <td>1846</td>
      <td>1846</td>
      <td>1846</td>
      <td>1846</td>
      <td>1846</td>
      <td>1846</td>
      <td>...</td>
      <td>1846</td>
      <td>1846</td>
      <td>1846</td>
      <td>1846</td>
      <td>1846</td>
      <td>1846</td>
      <td>1641</td>
      <td>1846</td>
      <td>0</td>
      <td>1846</td>
    </tr>
    <tr>
      <th>Thunderstorm Wind</th>
      <td>14350</td>
      <td>14350</td>
      <td>14350</td>
      <td>14350</td>
      <td>14350</td>
      <td>14350</td>
      <td>14350</td>
      <td>14350</td>
      <td>14350</td>
      <td>14350</td>
      <td>...</td>
      <td>14350</td>
      <td>14350</td>
      <td>14350</td>
      <td>14350</td>
      <td>14350</td>
      <td>14350</td>
      <td>13321</td>
      <td>14350</td>
      <td>0</td>
      <td>14350</td>
    </tr>
    <tr>
      <th>Tornado</th>
      <td>1337</td>
      <td>1337</td>
      <td>1337</td>
      <td>1337</td>
      <td>1337</td>
      <td>1337</td>
      <td>1337</td>
      <td>1337</td>
      <td>1337</td>
      <td>1337</td>
      <td>...</td>
      <td>1337</td>
      <td>1337</td>
      <td>1337</td>
      <td>1337</td>
      <td>1337</td>
      <td>1337</td>
      <td>1337</td>
      <td>1337</td>
      <td>1187</td>
      <td>1337</td>
    </tr>
    <tr>
      <th>Waterspout</th>
      <td>139</td>
      <td>139</td>
      <td>139</td>
      <td>139</td>
      <td>139</td>
      <td>139</td>
      <td>139</td>
      <td>139</td>
      <td>139</td>
      <td>139</td>
      <td>...</td>
      <td>139</td>
      <td>139</td>
      <td>139</td>
      <td>139</td>
      <td>139</td>
      <td>139</td>
      <td>132</td>
      <td>139</td>
      <td>0</td>
      <td>139</td>
    </tr>
  </tbody>
</table>
<p>15 rows × 63 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">spc_events</span><span class="p">[(</span><span class="n">spc_events</span><span class="o">.</span><span class="n">datetime_utc</span> <span class="o">&gt;</span> <span class="n">start_date</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">spc_events</span><span class="o">.</span><span class="n">EVENT_TYPE</span> <span class="o">==</span> <span class="s1">&#39;Hail&#39;</span><span class="p">)])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5617
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create geodataframe with 5 degree boxes</span>
<span class="n">boxes</span> <span class="o">=</span> <span class="n">plot_boxes</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create plot and add geo axis</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>

<span class="c1"># Add some cartopy features</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">LAND</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">OCEAN</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">LAKES</span><span class="p">)</span>

<span class="c1"># Plot the polygons</span>
<span class="n">gdf_regions</span> <span class="o">=</span> <span class="n">boxes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="c1"># Loop through and add labels to each box</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">boxes</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">)):</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">boxes</span><span class="o">.</span><span class="n">mid_lon</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
             <span class="n">boxes</span><span class="o">.</span><span class="n">mid_lat</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
             <span class="nb">str</span><span class="p">(</span><span class="n">boxes</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>
             <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="o">-</span><span class="mf">99.419650</span><span class="p">,</span> <span class="mf">34.044643</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;5 x 5 Degree Subregions&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/cartopy/io/__init__.py:260: DownloadWarning: Downloading: https://naciscdn.org/naturalearth/50m/physical/ne_50m_land.zip
  warnings.warn(&#39;Downloading: {}&#39;.format(url), DownloadWarning)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/cartopy/io/__init__.py:260: DownloadWarning: Downloading: https://naciscdn.org/naturalearth/50m/physical/ne_50m_ocean.zip
  warnings.warn(&#39;Downloading: {}&#39;.format(url), DownloadWarning)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/cartopy/io/__init__.py:260: DownloadWarning: Downloading: https://naciscdn.org/naturalearth/50m/physical/ne_50m_lakes.zip
  warnings.warn(&#39;Downloading: {}&#39;.format(url), DownloadWarning)
</pre></div>
</div>
<img alt="_images/ot-spc-comparison_120_1.png" src="_images/ot-spc-comparison_120_1.png" />
</div>
</div>
<div class="section" id="these-are-the-5x5-degree-boxes-within-the-domain-of-this-study">
<h2>These are the 5x5 degree boxes within the domain of this study<a class="headerlink" href="#these-are-the-5x5-degree-boxes-within-the-domain-of-this-study" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read in the OT data again</span>
<span class="n">ot_data</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s1">&#39;data/ots_20200410_20200930.geojson&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ot_data</span> <span class="o">=</span> <span class="n">ot_data</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;area_polygon&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert the OT data from polygon to point data, using the parallax corrected minimum brightness temperature point</span>
<span class="n">ota_geom</span> <span class="o">=</span> <span class="p">[</span><span class="n">Point</span><span class="p">(</span><span class="n">xy</span><span class="p">)</span> <span class="k">for</span> <span class="n">xy</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ot_data</span><span class="o">.</span><span class="n">lon_corr</span><span class="p">,</span> <span class="n">ot_data</span><span class="o">.</span><span class="n">lat_corr</span><span class="p">)]</span>

<span class="c1"># Add the new geometry to the geodataframe</span>
<span class="n">ot_data</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">ot_data</span><span class="p">,</span> <span class="n">geometry</span><span class="o">=</span><span class="n">ota_geom</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="s2">&quot;EPSG:4326&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ot_data</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">ot_data</span><span class="o">.</span><span class="n">time</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set the box_index variable to store each box&#39;s index value</span>
<span class="n">boxes</span><span class="p">[</span><span class="s1">&#39;box_index&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">boxes</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Spatially join the OTs and lat/lon boxes</span>
<span class="n">sub_regions</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">sjoin</span><span class="p">(</span><span class="n">ot_data</span><span class="p">,</span> <span class="n">boxes</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sub_regions</span><span class="p">[</span><span class="s1">&#39;month&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sub_regions</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span>
<span class="n">sub_regions</span><span class="p">[</span><span class="s1">&#39;day&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sub_regions</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">day</span>
<span class="n">sub_regions</span><span class="p">[</span><span class="s1">&#39;hour&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sub_regions</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">hour</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mf">34.044643</span> <span class="o">-</span><span class="mf">99.419650</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">08</span> <span class="mi">00</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mi">14</span> 	<span class="mf">78.832421</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hail_matched</span><span class="p">[</span><span class="n">hail_matched</span><span class="o">.</span><span class="n">MAGNITUDE</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time</th>
      <th>area_polygon</th>
      <th>cloudtop_height</th>
      <th>e_radial</th>
      <th>e_radial_del2</th>
      <th>e_tb</th>
      <th>lat</th>
      <th>lat_corr</th>
      <th>lon</th>
      <th>lon_corr</th>
      <th>...</th>
      <th>EPISODE_NARRATIVE</th>
      <th>EVENT_NARRATIVE</th>
      <th>DATA_SOURCE</th>
      <th>EF_RATING</th>
      <th>datetime_utc</th>
      <th>day_right</th>
      <th>month_right</th>
      <th>haz_datetime</th>
      <th>ota_datetime</th>
      <th>abs_time_diff</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5833</th>
      <td>2020-05-08 00:20:14</td>
      <td>78.832421</td>
      <td>15.988001</td>
      <td>6.586952</td>
      <td>[ 0.29672241  0.40038681  0.44083405  0.381786...</td>
      <td>[198.74661255 198.59190369 199.03063965 199.88...</td>
      <td>34.151787</td>
      <td>34.017788</td>
      <td>-99.419650</td>
      <td>-99.321648</td>
      <td>...</td>
      <td>A very intense supercell produced a long swath...</td>
      <td>NaN</td>
      <td>CSV</td>
      <td>NaN</td>
      <td>2020-05-08 00:05:00+00:00</td>
      <td>8</td>
      <td>5</td>
      <td>2020-05-08 00:05:00+00:00</td>
      <td>2020-05-08 00:20:14+00:00</td>
      <td>00:15:14</td>
    </tr>
    <tr>
      <th>5830</th>
      <td>2020-05-08 00:10:14</td>
      <td>45.363143</td>
      <td>14.664001</td>
      <td>4.397308</td>
      <td>[ 0.17149353  0.23894882  0.24906158  0.104244...</td>
      <td>[203.9979248  204.19569397 204.7364502  205.54...</td>
      <td>34.044643</td>
      <td>33.922642</td>
      <td>-99.508934</td>
      <td>-99.418938</td>
      <td>...</td>
      <td>A very intense supercell produced a long swath...</td>
      <td>NaN</td>
      <td>CSV</td>
      <td>NaN</td>
      <td>2020-05-08 00:05:00+00:00</td>
      <td>8</td>
      <td>5</td>
      <td>2020-05-08 00:05:00+00:00</td>
      <td>2020-05-08 00:10:14+00:00</td>
      <td>00:05:14</td>
    </tr>
    <tr>
      <th>5836</th>
      <td>2020-05-08 00:30:14</td>
      <td>43.114685</td>
      <td>15.609001</td>
      <td>5.499032</td>
      <td>[ 3.48236084e-01  4.48810577e-01  4.16099548e-...</td>
      <td>[202.01490784 201.47436523 201.6302948  202.18...</td>
      <td>33.991074</td>
      <td>33.861073</td>
      <td>-99.437500</td>
      <td>-99.342499</td>
      <td>...</td>
      <td>A very intense supercell produced a long swath...</td>
      <td>NaN</td>
      <td>CSV</td>
      <td>NaN</td>
      <td>2020-05-08 00:05:00+00:00</td>
      <td>8</td>
      <td>5</td>
      <td>2020-05-08 00:05:00+00:00</td>
      <td>2020-05-08 00:30:14+00:00</td>
      <td>00:25:14</td>
    </tr>
    <tr>
      <th>16027</th>
      <td>2020-06-21 00:30:22</td>
      <td>73.152502</td>
      <td>13.509001</td>
      <td>3.084084</td>
      <td>[ 0.17436218  0.21333694  0.13891983 -0.085189...</td>
      <td>[211.33145142 212.00418091 213.02563477 214.20...</td>
      <td>39.205357</td>
      <td>39.066357</td>
      <td>-99.812500</td>
      <td>-99.721497</td>
      <td>...</td>
      <td>Although storm coverage within this portion of...</td>
      <td>Hail ranging in size from ping pong balls to 3...</td>
      <td>CSV</td>
      <td>NaN</td>
      <td>2020-06-21 00:08:00+00:00</td>
      <td>21</td>
      <td>6</td>
      <td>2020-06-21 00:08:00+00:00</td>
      <td>2020-06-21 00:30:22+00:00</td>
      <td>00:22:22</td>
    </tr>
    <tr>
      <th>16624</th>
      <td>2020-06-21 21:00:22</td>
      <td>43.013797</td>
      <td>15.049001</td>
      <td>4.131079</td>
      <td>[ 0.28108978  0.3908577   0.40057373  0.152622...</td>
      <td>[203.02441406 203.77285767 205.08348083 206.83...</td>
      <td>38.901787</td>
      <td>38.750786</td>
      <td>-98.616070</td>
      <td>-98.520073</td>
      <td>...</td>
      <td>Clusters of thunderstorms moved across central...</td>
      <td>Estimated 3.25 inch hail between Holyrood and ...</td>
      <td>CSV</td>
      <td>NaN</td>
      <td>2020-06-21 20:33:00+00:00</td>
      <td>21</td>
      <td>6</td>
      <td>2020-06-21 20:33:00+00:00</td>
      <td>2020-06-21 21:00:22+00:00</td>
      <td>00:27:22</td>
    </tr>
    <tr>
      <th>18722</th>
      <td>2020-06-24 23:20:20</td>
      <td>78.104413</td>
      <td>14.253000</td>
      <td>8.333426</td>
      <td>[ 0.0604248   0.08716965  0.11168289  0.119003...</td>
      <td>[206.18257141 206.34037781 206.61903381 207.00...</td>
      <td>38.276787</td>
      <td>38.136787</td>
      <td>-99.276790</td>
      <td>-99.184784</td>
      <td>...</td>
      <td>A weak outflow boundary from morning storms se...</td>
      <td>NaN</td>
      <td>CSV</td>
      <td>NaN</td>
      <td>2020-06-24 23:00:00+00:00</td>
      <td>24</td>
      <td>6</td>
      <td>2020-06-24 23:00:00+00:00</td>
      <td>2020-06-24 23:20:20+00:00</td>
      <td>00:20:20</td>
    </tr>
    <tr>
      <th>18716</th>
      <td>2020-06-24 23:10:20</td>
      <td>37.262727</td>
      <td>14.475000</td>
      <td>3.127246</td>
      <td>[ 0.14801788  0.17140579  0.08745193 -0.100944...</td>
      <td>[206.26252747 206.55007935 207.13366699 207.81...</td>
      <td>38.223213</td>
      <td>38.081215</td>
      <td>-99.383934</td>
      <td>-99.289932</td>
      <td>...</td>
      <td>A weak outflow boundary from morning storms se...</td>
      <td>NaN</td>
      <td>CSV</td>
      <td>NaN</td>
      <td>2020-06-24 23:00:00+00:00</td>
      <td>24</td>
      <td>6</td>
      <td>2020-06-24 23:00:00+00:00</td>
      <td>2020-06-24 23:10:20+00:00</td>
      <td>00:10:20</td>
    </tr>
    <tr>
      <th>19323</th>
      <td>2020-06-25 22:10:20</td>
      <td>105.474914</td>
      <td>14.318001</td>
      <td>6.260703</td>
      <td>[ 0.03448486  0.05452347  0.07659912  0.074192...</td>
      <td>[206.3817749  206.16294861 206.01309204 205.94...</td>
      <td>47.651787</td>
      <td>42.759499</td>
      <td>-97.241070</td>
      <td>-103.526787</td>
      <td>...</td>
      <td>Strong thunderstorm produced hail stones up to...</td>
      <td>Large hail damaged resident's windows and neig...</td>
      <td>CSV</td>
      <td>NaN</td>
      <td>2020-06-25 21:38:00+00:00</td>
      <td>25</td>
      <td>6</td>
      <td>2020-06-25 21:38:00+00:00</td>
      <td>2020-06-25 22:10:20+00:00</td>
      <td>00:32:20</td>
    </tr>
    <tr>
      <th>24721</th>
      <td>2020-07-11 20:10:24</td>
      <td>40.357395</td>
      <td>16.919001</td>
      <td>4.152719</td>
      <td>[ 0.34606934  0.45185852  0.43415833  0.219947...</td>
      <td>[200.20252991 200.21508789 200.91978455 202.04...</td>
      <td>38.526787</td>
      <td>38.363789</td>
      <td>-95.669650</td>
      <td>-95.578644</td>
      <td>...</td>
      <td>Supercell thunderstorms developed late morning...</td>
      <td>Report of up to 3.25 inch hail.</td>
      <td>CSV</td>
      <td>NaN</td>
      <td>2020-07-11 19:37:00+00:00</td>
      <td>11</td>
      <td>7</td>
      <td>2020-07-11 19:37:00+00:00</td>
      <td>2020-07-11 20:10:24+00:00</td>
      <td>00:33:24</td>
    </tr>
    <tr>
      <th>28572</th>
      <td>2020-07-20 01:10:26</td>
      <td>74.064903</td>
      <td>14.637001</td>
      <td>5.787165</td>
      <td>[ 0.14334869  0.21454239  0.27547836  0.234977...</td>
      <td>[205.03457642 205.25453186 205.76118469 206.55...</td>
      <td>43.383926</td>
      <td>43.195927</td>
      <td>-105.044640</td>
      <td>-104.907639</td>
      <td>...</td>
      <td>Very large hail reported with severe thunderst...</td>
      <td>NaN</td>
      <td>CSV</td>
      <td>NaN</td>
      <td>2020-07-20 00:45:00+00:00</td>
      <td>20</td>
      <td>7</td>
      <td>2020-07-20 00:45:00+00:00</td>
      <td>2020-07-20 01:10:26+00:00</td>
      <td>00:25:26</td>
    </tr>
    <tr>
      <th>48890</th>
      <td>2020-08-27 00:20:20</td>
      <td>78.146912</td>
      <td>15.589001</td>
      <td>3.828216</td>
      <td>[ 0.17086029  0.23066711  0.22599411  0.082199...</td>
      <td>[205.26055908 205.54760742 206.17637634 207.04...</td>
      <td>43.866070</td>
      <td>43.670071</td>
      <td>-101.455360</td>
      <td>-101.330360</td>
      <td>...</td>
      <td>A supercell thunderstorm developed over wester...</td>
      <td>Very large hail broke the windshield of a law ...</td>
      <td>CSV</td>
      <td>NaN</td>
      <td>2020-08-27 00:00:00+00:00</td>
      <td>27</td>
      <td>8</td>
      <td>2020-08-27 00:00:00+00:00</td>
      <td>2020-08-27 00:20:20+00:00</td>
      <td>00:20:20</td>
    </tr>
  </tbody>
</table>
<p>11 rows × 117 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sub_regions</span><span class="o">.</span><span class="n">mid_lat</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>47.5
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">box_num</span> <span class="o">=</span> <span class="mi">19</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">count</span> <span class="o">=</span> <span class="n">sub_regions</span><span class="p">[(</span><span class="n">sub_regions</span><span class="o">.</span><span class="n">month</span> <span class="o">==</span> <span class="mi">8</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">sub_regions</span><span class="o">.</span><span class="n">day</span> <span class="o">==</span> <span class="mi">20</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">sub_regions</span><span class="o">.</span><span class="n">box_index</span> <span class="o">==</span> <span class="n">box_num</span><span class="p">)]</span><span class="o">.</span><span class="n">area_polygon</span>
<span class="n">count</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;n = </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">count</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;OTA ($km^2$)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;OTA Frequency August 20 2020 </span><span class="se">\n</span><span class="s1"> Subregion: </span><span class="si">{</span><span class="n">box_num</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;OT_freq_aug_20.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ot-spc-comparison_133_0.png" src="_images/ot-spc-comparison_133_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">box_num</span> <span class="o">=</span> <span class="mi">19</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">count</span> <span class="o">=</span> <span class="n">sub_regions</span><span class="p">[(</span><span class="n">sub_regions</span><span class="o">.</span><span class="n">month</span> <span class="o">==</span> <span class="mi">8</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">sub_regions</span><span class="o">.</span><span class="n">day</span> <span class="o">==</span> <span class="mi">20</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">sub_regions</span><span class="o">.</span><span class="n">box_index</span> <span class="o">==</span> <span class="n">box_num</span><span class="p">)]</span><span class="o">.</span><span class="n">ot_depth</span>
<span class="n">count</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">5.25</span><span class="p">,</span> <span class="mf">.25</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;n = </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">count</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;OT Depth ($km$)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;OT Depth Frequency August 20 2020 </span><span class="se">\n</span><span class="s1"> Subregion: </span><span class="si">{</span><span class="n">box_num</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;OT_depth_freq_aug_20.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ot-spc-comparison_134_0.png" src="_images/ot-spc-comparison_134_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">box_num</span> <span class="o">=</span> <span class="mi">25</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">sub</span> <span class="o">=</span> <span class="n">sub_regions</span><span class="p">[(</span><span class="n">sub_regions</span><span class="o">.</span><span class="n">month</span> <span class="o">==</span> <span class="mi">5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">sub_regions</span><span class="o">.</span><span class="n">day</span> <span class="o">==</span> <span class="mi">8</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">sub_regions</span><span class="o">.</span><span class="n">box_index</span> <span class="o">==</span> <span class="n">box_num</span><span class="p">)]</span>
<span class="n">count</span> <span class="o">=</span> <span class="n">sub</span><span class="o">.</span><span class="n">area_polygon</span>
<span class="n">count</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;n = </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">count</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;OTA ($km^2$)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

<span class="n">time</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">sub</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">10</span><span class="p">])</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%b </span><span class="si">%d</span><span class="s1"> %Y&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;OTA Frequency </span><span class="si">{</span><span class="n">time</span><span class="si">}</span><span class="s1"> </span><span class="se">\n</span><span class="s1"> Subregion: </span><span class="si">{</span><span class="n">box_num</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;OT_freq_may_08.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ot-spc-comparison_135_0.png" src="_images/ot-spc-comparison_135_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">box_num</span> <span class="o">=</span> <span class="mi">25</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">sub</span> <span class="o">=</span> <span class="n">sub_regions</span><span class="p">[(</span><span class="n">sub_regions</span><span class="o">.</span><span class="n">month</span> <span class="o">==</span> <span class="mi">5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">sub_regions</span><span class="o">.</span><span class="n">day</span> <span class="o">==</span> <span class="mi">8</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">sub_regions</span><span class="o">.</span><span class="n">box_index</span> <span class="o">==</span> <span class="n">box_num</span><span class="p">)]</span>
<span class="n">count</span> <span class="o">=</span> <span class="n">sub</span><span class="o">.</span><span class="n">ot_depth</span>
<span class="n">count</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">5.25</span><span class="p">,</span> <span class="mf">.25</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;n = </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">count</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;OT Depth ($km$)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;OT Depth Frequency </span><span class="si">{</span><span class="n">time</span><span class="si">}</span><span class="s1"> </span><span class="se">\n</span><span class="s1"> Subregion: </span><span class="si">{</span><span class="n">box_num</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;OT_depth_freq_may_08.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ot-spc-comparison_136_0.png" src="_images/ot-spc-comparison_136_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add a line showing the expected distribution.</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">((</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="n">sigma</span><span class="p">))</span> <span class="o">*</span>
     <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">sigma</span> <span class="o">*</span> <span class="p">(</span><span class="n">bins</span> <span class="o">-</span> <span class="n">mu</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
<span class="n">y</span> <span class="o">/=</span> <span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bins</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Theoretical&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">115</span><span class="o">-</span><span class="mi">628303603</span><span class="n">f8c</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1"># Add a line showing the expected distribution.</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">y</span> <span class="o">=</span> <span class="p">((</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="n">sigma</span><span class="p">))</span> <span class="o">*</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span>      <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">sigma</span> <span class="o">*</span> <span class="p">(</span><span class="n">bins</span> <span class="o">-</span> <span class="n">mu</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">y</span> <span class="o">/=</span> <span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="ne">NameError</span>: name &#39;sigma&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_frequency</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
    
    <span class="c1"># Dissolve OTs within the boxes using mean, median, and counts</span>
    <span class="n">avg_boxes</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dissolve</span><span class="p">(</span><span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="s1">&#39;box_index&#39;</span><span class="p">)</span>
    <span class="n">med_boxes</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dissolve</span><span class="p">(</span><span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;median&#39;</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="s1">&#39;box_index&#39;</span><span class="p">)</span>
    <span class="n">count_boxes</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dissolve</span><span class="p">(</span><span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="s1">&#39;box_index&#39;</span><span class="p">)</span>
    
    <span class="c1"># Determine frequency of OTs by weighting by total number</span>
    <span class="n">count_boxes</span><span class="p">[</span><span class="s1">&#39;freq&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">count_boxes</span><span class="p">[</span><span class="s1">&#39;area_polygon&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">count_boxes</span><span class="o">.</span><span class="n">area_polygon</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">count_boxes</span><span class="o">.</span><span class="n">area_polygon</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
    <span class="n">avg_boxes</span><span class="p">[</span><span class="s1">&#39;area_weighted&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">avg_boxes</span><span class="p">[</span><span class="s1">&#39;area_polygon&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">count_boxes</span><span class="o">.</span><span class="n">area_polygon</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    
    <span class="c1"># Plot OT frequency</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>

    <span class="c1"># Plot OT frequency, using Red colormap</span>
    <span class="n">count_boxes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="s1">&#39;freq&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Reds&#39;</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">LAND</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">OCEAN</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">BORDERS</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">STATES</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">COASTLINE</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;OT Frequency </span><span class="se">\n</span><span class="s1"> </span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;OT_Freq_</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s1">.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="c1">##############################</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
    <span class="n">avg_boxes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="s1">&#39;area_polygon&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Reds&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">LAND</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">OCEAN</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">BORDERS</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">STATES</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">COASTLINE</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Average OTA ($km^</span><span class="si">{</span><span class="mi">2</span><span class="si">}</span><span class="s1">$) </span><span class="se">\n</span><span class="s1"> </span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
    <span class="c1">#plt.savefig(f&#39;OTA_Avg_{label}.png&#39;, dpi=200)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">();</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">sub_regions</span><span class="o">.</span><span class="n">month</span><span class="p">):</span>
    <span class="n">month_ab</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%b&#39;</span><span class="p">)</span>
    
    <span class="n">plot_frequency</span><span class="p">(</span><span class="n">sub_regions</span><span class="p">[</span><span class="n">sub_regions</span><span class="o">.</span><span class="n">month</span> <span class="o">==</span> <span class="n">i</span><span class="p">],</span> <span class="n">month_ab</span> <span class="o">+</span> <span class="s1">&#39; 2020&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3946
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/cartopy/io/__init__.py:260: DownloadWarning: Downloading: https://naciscdn.org/naturalearth/50m/cultural/ne_50m_admin_0_boundary_lines_land.zip
  warnings.warn(&#39;Downloading: {}&#39;.format(url), DownloadWarning)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/cartopy/io/__init__.py:260: DownloadWarning: Downloading: https://naciscdn.org/naturalearth/50m/cultural/ne_50m_admin_1_states_provinces_lakes.zip
  warnings.warn(&#39;Downloading: {}&#39;.format(url), DownloadWarning)
/opt/conda/envs/geoai-py3/lib/python3.6/site-packages/cartopy/io/__init__.py:260: DownloadWarning: Downloading: https://naciscdn.org/naturalearth/50m/physical/ne_50m_coastline.zip
  warnings.warn(&#39;Downloading: {}&#39;.format(url), DownloadWarning)
</pre></div>
</div>
<img alt="_images/ot-spc-comparison_139_2.png" src="_images/ot-spc-comparison_139_2.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2427
</pre></div>
</div>
<img alt="_images/ot-spc-comparison_139_4.png" src="_images/ot-spc-comparison_139_4.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>13985
</pre></div>
</div>
<img alt="_images/ot-spc-comparison_139_6.png" src="_images/ot-spc-comparison_139_6.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>13091
</pre></div>
</div>
<img alt="_images/ot-spc-comparison_139_8.png" src="_images/ot-spc-comparison_139_8.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>15202
</pre></div>
</div>
<img alt="_images/ot-spc-comparison_139_10.png" src="_images/ot-spc-comparison_139_10.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>13313
</pre></div>
</div>
<img alt="_images/ot-spc-comparison_139_12.png" src="_images/ot-spc-comparison_139_12.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">sub_regions</span><span class="o">.</span><span class="n">hour</span><span class="p">):</span>
    
    <span class="n">plot_frequency</span><span class="p">(</span><span class="n">sub_regions</span><span class="p">[</span><span class="n">sub_regions</span><span class="o">.</span><span class="n">hour</span> <span class="o">==</span> <span class="n">i</span><span class="p">],</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; UTC 2020&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_frequency</span><span class="p">(</span><span class="n">sub_regions</span><span class="p">,</span> <span class="s1">&#39;April - September 2020&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>61964
</pre></div>
</div>
<img alt="_images/ot-spc-comparison_141_1.png" src="_images/ot-spc-comparison_141_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Dissolve OTs within the boxes using mean, median, and counts</span>
<span class="n">avg_boxes</span> <span class="o">=</span> <span class="n">sub_regions</span><span class="o">.</span><span class="n">dissolve</span><span class="p">(</span><span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="s1">&#39;box_index&#39;</span><span class="p">)</span>
<span class="n">med_boxes</span> <span class="o">=</span> <span class="n">sub_regions</span><span class="o">.</span><span class="n">dissolve</span><span class="p">(</span><span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;median&#39;</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="s1">&#39;box_index&#39;</span><span class="p">)</span>
<span class="n">count_boxes</span> <span class="o">=</span> <span class="n">sub_regions</span><span class="o">.</span><span class="n">dissolve</span><span class="p">(</span><span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="s1">&#39;box_index&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mean_ota</span> <span class="o">=</span> <span class="n">sub_regions</span><span class="p">[(</span><span class="n">sub_regions</span><span class="o">.</span><span class="n">box_index</span> <span class="o">==</span> <span class="n">box_num</span><span class="p">)]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;hour&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">area_polygon</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">count_ots</span> <span class="o">=</span> <span class="n">sub_regions</span><span class="p">[(</span><span class="n">sub_regions</span><span class="o">.</span><span class="n">box_index</span> <span class="o">==</span> <span class="n">box_num</span><span class="p">)]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;hour&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">area_polygon</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sub_regions</span><span class="p">[(</span><span class="n">sub_regions</span><span class="o">.</span><span class="n">time</span> <span class="o">&gt;=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">sub_regions</span><span class="o">.</span><span class="n">time</span> <span class="o">&lt;=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">))]</span><span class="o">.</span><span class="n">area_polygon</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">hist</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fc798c16940&gt;
</pre></div>
</div>
<img alt="_images/ot-spc-comparison_145_1.png" src="_images/ot-spc-comparison_145_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">box_num</span> <span class="o">=</span> <span class="mi">2</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">count</span> <span class="o">=</span> <span class="n">sub_regions</span><span class="p">[(</span><span class="n">sub_regions</span><span class="o">.</span><span class="n">box_index</span> <span class="o">==</span> <span class="n">box_num</span><span class="p">)]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;hour&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">area_polygon</span>
<span class="n">count</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;n = </span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="n">count</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Hour (UTC)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Hourly Distribution OTs </span><span class="se">\n</span><span class="s1"> Subregion: </span><span class="si">{</span><span class="n">box_num</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Hourly Distribution OTs \n Subregion: 2&#39;)
</pre></div>
</div>
<img alt="_images/ot-spc-comparison_146_1.png" src="_images/ot-spc-comparison_146_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sub1</span> <span class="o">=</span> <span class="mi">42</span>
<span class="n">sub2</span> <span class="o">=</span> <span class="mi">19</span>
<span class="n">sub3</span><span class="o">=</span> <span class="mi">2</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">sub_regions</span><span class="p">[(</span><span class="n">sub_regions</span><span class="o">.</span><span class="n">box_index</span> <span class="o">==</span> <span class="n">sub1</span><span class="p">)]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;hour&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">area_polygon</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Subregion </span><span class="si">{</span><span class="n">sub1</span><span class="si">}</span><span class="s1"> - Iowa&#39;</span><span class="p">)</span>
<span class="n">sub_regions</span><span class="p">[(</span><span class="n">sub_regions</span><span class="o">.</span><span class="n">box_index</span> <span class="o">==</span> <span class="n">sub2</span><span class="p">)]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;hour&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">area_polygon</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Subregion </span><span class="si">{</span><span class="n">sub2</span><span class="si">}</span><span class="s1"> - Gulf Coast&#39;</span><span class="p">)</span>
<span class="n">sub_regions</span><span class="p">[(</span><span class="n">sub_regions</span><span class="o">.</span><span class="n">box_index</span> <span class="o">==</span> <span class="n">sub3</span><span class="p">)]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;hour&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">area_polygon</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Subregion </span><span class="si">{</span><span class="n">sub3</span><span class="si">}</span><span class="s1"> - Mexico&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Hour (UTC)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;OTA ($km^</span><span class="si">{2}</span><span class="s1">$)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Hourly Distribution Max Area OTs&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Hourly Distribution Max Area OTs&#39;)
</pre></div>
</div>
<img alt="_images/ot-spc-comparison_147_1.png" src="_images/ot-spc-comparison_147_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sub1</span> <span class="o">=</span> <span class="mi">42</span>
<span class="n">sub2</span> <span class="o">=</span> <span class="mi">19</span>
<span class="n">sub3</span><span class="o">=</span> <span class="mi">2</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">sub_regions</span><span class="p">[(</span><span class="n">sub_regions</span><span class="o">.</span><span class="n">box_index</span> <span class="o">==</span> <span class="n">sub1</span><span class="p">)]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;hour&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">area_polygon</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Subregion </span><span class="si">{</span><span class="n">sub1</span><span class="si">}</span><span class="s1"> - Iowa&#39;</span><span class="p">)</span>
<span class="n">sub_regions</span><span class="p">[(</span><span class="n">sub_regions</span><span class="o">.</span><span class="n">box_index</span> <span class="o">==</span> <span class="n">sub2</span><span class="p">)]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;hour&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">area_polygon</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Subregion </span><span class="si">{</span><span class="n">sub2</span><span class="si">}</span><span class="s1"> - Gulf Coast&#39;</span><span class="p">)</span>
<span class="n">sub_regions</span><span class="p">[(</span><span class="n">sub_regions</span><span class="o">.</span><span class="n">box_index</span> <span class="o">==</span> <span class="n">sub3</span><span class="p">)]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;hour&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">area_polygon</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Subregion </span><span class="si">{</span><span class="n">sub3</span><span class="si">}</span><span class="s1"> - Mexico&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Hour (UTC)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;OT Frequency&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Hourly Distribution OT Frequency&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Hourly Distribution OT Frequency&#39;)
</pre></div>
</div>
<img alt="_images/ot-spc-comparison_148_1.png" src="_images/ot-spc-comparison_148_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">box_num</span> <span class="o">=</span> <span class="mi">2</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">24</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">9</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
    <span class="n">subset</span> <span class="o">=</span> <span class="n">sub_regions</span><span class="p">[(</span><span class="n">sub_regions</span><span class="o">.</span><span class="n">box_index</span> <span class="o">==</span> <span class="n">box_num</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">sub_regions</span><span class="o">.</span><span class="n">hour</span> <span class="o">==</span> <span class="n">i</span><span class="p">)]</span>
    <span class="n">mean</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">subset</span><span class="o">.</span><span class="n">area_polygon</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">median</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">subset</span><span class="o">.</span><span class="n">area_polygon</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">maxm</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">subset</span><span class="o">.</span><span class="n">area_polygon</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
    
    <span class="n">subset</span><span class="o">.</span><span class="n">area_polygon</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">275</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;n = </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">subset</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Mean Area = </span><span class="si">{</span><span class="n">mean</span><span class="si">}</span><span class="s1"> $km^</span><span class="si">{</span><span class="mi">2</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">median</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Median Area = </span><span class="si">{</span><span class="n">median</span><span class="si">}</span><span class="s1"> $km^</span><span class="si">{</span><span class="mi">2</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">maxm</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Max Area = </span><span class="si">{</span><span class="n">maxm</span><span class="si">}</span><span class="s1"> $km^</span><span class="si">{</span><span class="mi">2</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Subregion: </span><span class="si">{</span><span class="n">box_num</span><span class="si">}</span><span class="s1"> </span><span class="se">\n</span><span class="s1"> </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1"> UTC&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;OTA ($km^</span><span class="si">{2}</span><span class="s1">$)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ot-spc-comparison_149_0.png" src="_images/ot-spc-comparison_149_0.png" />
<img alt="_images/ot-spc-comparison_149_1.png" src="_images/ot-spc-comparison_149_1.png" />
<img alt="_images/ot-spc-comparison_149_2.png" src="_images/ot-spc-comparison_149_2.png" />
<img alt="_images/ot-spc-comparison_149_3.png" src="_images/ot-spc-comparison_149_3.png" />
<img alt="_images/ot-spc-comparison_149_4.png" src="_images/ot-spc-comparison_149_4.png" />
<img alt="_images/ot-spc-comparison_149_5.png" src="_images/ot-spc-comparison_149_5.png" />
<img alt="_images/ot-spc-comparison_149_6.png" src="_images/ot-spc-comparison_149_6.png" />
<img alt="_images/ot-spc-comparison_149_7.png" src="_images/ot-spc-comparison_149_7.png" />
<img alt="_images/ot-spc-comparison_149_8.png" src="_images/ot-spc-comparison_149_8.png" />
<img alt="_images/ot-spc-comparison_149_9.png" src="_images/ot-spc-comparison_149_9.png" />
<img alt="_images/ot-spc-comparison_149_10.png" src="_images/ot-spc-comparison_149_10.png" />
<img alt="_images/ot-spc-comparison_149_11.png" src="_images/ot-spc-comparison_149_11.png" />
<img alt="_images/ot-spc-comparison_149_12.png" src="_images/ot-spc-comparison_149_12.png" />
<img alt="_images/ot-spc-comparison_149_13.png" src="_images/ot-spc-comparison_149_13.png" />
<img alt="_images/ot-spc-comparison_149_14.png" src="_images/ot-spc-comparison_149_14.png" />
<img alt="_images/ot-spc-comparison_149_15.png" src="_images/ot-spc-comparison_149_15.png" />
<img alt="_images/ot-spc-comparison_149_16.png" src="_images/ot-spc-comparison_149_16.png" />
<img alt="_images/ot-spc-comparison_149_17.png" src="_images/ot-spc-comparison_149_17.png" />
<img alt="_images/ot-spc-comparison_149_18.png" src="_images/ot-spc-comparison_149_18.png" />
<img alt="_images/ot-spc-comparison_149_19.png" src="_images/ot-spc-comparison_149_19.png" />
<img alt="_images/ot-spc-comparison_149_20.png" src="_images/ot-spc-comparison_149_20.png" />
<img alt="_images/ot-spc-comparison_149_21.png" src="_images/ot-spc-comparison_149_21.png" />
<img alt="_images/ot-spc-comparison_149_22.png" src="_images/ot-spc-comparison_149_22.png" />
<img alt="_images/ot-spc-comparison_149_23.png" src="_images/ot-spc-comparison_149_23.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">avg_boxes</span><span class="p">[</span><span class="n">avg_boxes</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="mi">19</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>geometry</th>
      <th>index_left</th>
      <th>area_polygon</th>
      <th>cloudtop_height</th>
      <th>e_radial</th>
      <th>lat</th>
      <th>lat_corr</th>
      <th>lon</th>
      <th>lon_corr</th>
      <th>mintb</th>
      <th>...</th>
      <th>area_circle_median</th>
      <th>area_circle_polygon</th>
      <th>ot_depth</th>
      <th>max_radial</th>
      <th>meanrad</th>
      <th>otarea_circle</th>
      <th>month</th>
      <th>hour</th>
      <th>mid_lon</th>
      <th>mid_lat</th>
    </tr>
    <tr>
      <th>box_index</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>19</th>
      <td>POLYGON ((-90.00000 30.00000, -85.00000 30.000...</td>
      <td>42264.132502</td>
      <td>53.935065</td>
      <td>16.804654</td>
      <td>4.391166</td>
      <td>28.266257</td>
      <td>27.886634</td>
      <td>-87.261666</td>
      <td>-87.398533</td>
      <td>194.07067</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.041069</td>
      <td>6.422426</td>
      <td>4.191254</td>
      <td>59.343445</td>
      <td>7.610288</td>
      <td>11.537802</td>
      <td>-87.5</td>
      <td>27.5</td>
    </tr>
  </tbody>
</table>
<p>1 rows × 33 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Determine frequency of OTs by weighting by total number</span>
<span class="n">count_boxes</span><span class="p">[</span><span class="s1">&#39;freq&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">count_boxes</span><span class="p">[</span><span class="s1">&#39;area_polygon&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">count_boxes</span><span class="o">.</span><span class="n">area_polygon</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">count_boxes</span><span class="o">.</span><span class="n">area_polygon</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>61964
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot OT frequency</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>

<span class="c1"># Plot OT frequency, using Red colormap</span>
<span class="n">count_boxes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="s1">&#39;freq&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Reds&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">LAND</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">OCEAN</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">BORDERS</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">STATES</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">COASTLINE</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;OT Frequency </span><span class="se">\n</span><span class="s1"> 10 April - 31 September 2020&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;OT_freq_2020.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ot-spc-comparison_153_0.png" src="_images/ot-spc-comparison_153_0.png" />
</div>
</div>
<p>There are three primary regions of maximum OT frequency between April-September 2020:</p>
<ol class="simple">
<li><p>Upper Midwest/Great Plains</p>
<ol class="simple">
<li><p>This is likely due to Mesoscale Convective Systems (MCS)</p></li>
<li><p>The Midwestern Derecho from 10 August 2020 (one of greatest frequency events, Nebraska –&gt; Wisconsin</p></li>
</ol>
</li>
<li><p>Northern Gulf of Mexico</p>
<ol class="simple">
<li><p>Tropical systems - there were several major hurricanes along the Gulf Coast in August/September 2020</p></li>
</ol>
</li>
<li><p>Southern Mexico/Central America</p>
<ol class="simple">
<li><p>There are several mountains within this region, as well as adequate moisture which leads to frequent overshooting convection, which was identified as a popular region for OTs in Liu and Zipser (2005)</p></li>
</ol>
</li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
<span class="n">avg_boxes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="s1">&#39;area_polygon&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Reds&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">LAND</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">OCEAN</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">BORDERS</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">STATES</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">COASTLINE</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Average OTA (km2)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ot-spc-comparison_155_0.png" src="_images/ot-spc-comparison_155_0.png" />
</div>
</div>
<p>There is not a clear signal in regions with larger OTA. Area averages may have been impacted by the small bins near the fringes of the domain (western edge) and the northeast corner (Maine/Canada)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
<span class="n">avg_boxes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="s1">&#39;mintb&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues_r&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">LAND</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">OCEAN</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">BORDERS</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">STATES</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">COASTLINE</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Minimum Brightness Temperature (K)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ot-spc-comparison_157_0.png" src="_images/ot-spc-comparison_157_0.png" />
</div>
</div>
<p>Minimum brightness temperature is strongly related to latitude - where tropical regions have lower minimum brightness temperature. This is because the tropopause is typically higher in the atmosphere near the tropics, and lower near the poles. Temperature generally decreases with height in the atmosphere, which explains why tropical regions would have cooler cloud top temperatures.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
<span class="n">avg_boxes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="s1">&#39;ot_depth&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Reds&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">LAND</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">OCEAN</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">BORDERS</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">STATES</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">COASTLINE</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Average OT Depth (km)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ot-spc-comparison_159_0.png" src="_images/ot-spc-comparison_159_0.png" />
</div>
</div>
<p>Average OT depth appears to have a strong relationship between continental and oceanic regions. Peak OT depth (the distance between the OT height and tropopause) is at a maximum in the Great Plains and Midwest, while the Gulf Coast and Atlantic coastal regions, in addition to the Carribean have relatively lower average OT depth. The convection near the center of the continent is likely deeper and has updrafts that are capable of producing more intense OTs than oceanic regions.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "geoai-py3"
        },
        kernelOptions: {
            kernelName: "geoai-py3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'geoai-py3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="intro.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title">Introduction</p>
            </div>
        </a>
    </div>

</div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By NCAR ESDS Team<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>